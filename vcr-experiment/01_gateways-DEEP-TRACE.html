

<!DOCTYPE html>
<html lang="en">

<head>
  
  <meta charset="UTF-8"/>

  <link rel="shortcut icon" href="../_static/favicon.ico" type="image/x-icon"/>

  
  
  <link rel="stylesheet" href="../_static/_base.css"/>
  <link rel="stylesheet" href="../_static/_layout.css"/>
  <link rel="stylesheet" href="../_static/_content.css"/>
  <link rel="stylesheet" href="../_static/_requirement.css"/>
  <link rel="stylesheet" href="../_static/_element.css"/>
  <link rel="stylesheet" href="../_static/_form.css"/>
  
  <link rel="stylesheet" href="../_static/_requirement-tree.css"/>


  
  <script type="text/javascript" src="../_static/toc.js"></script>
  <script type="text/javascript" src="../_static/jquery.min.js"></script>
  <script type="text/javascript" src="../_static/pan-with-space.js"></script>
  
  
  
  


  <title>Vehicle Network Gateway Devices Security Requirements - Deep Traceability</title>

  
</head>

<body class="deep-traceability-view withtoc" data-turbo="false">
<script>document.body.dataset.state = sessionStorage.getItem('tocState') || 'open';</script><div class="layout" id="layout">

    <aside class="layout_aside-header">
      
  <a class="index-link" href="../index.html">To Index</a>

    </aside>

    <aside class="layout_aside">
      
  <turbo-frame id="frame-toc">
    <div>Table of Contents</div>
    <ul class="toc"><li><a href="#1-Security-Requirements-for-Abstract-Intended-Gateways" data-turbo="false">
              <span class="section-number">1</span>
              Security Requirements for Abstract (Intended) Gateways
            </a><ul><li>
        <a href="#1.1-AGW-S-000" data-turbo="false">
          <span class="section-number">1.1</span>
          Gateway Configuration Protected
        </a></li><li>
        <a href="#1.2-AGW-S-001" data-turbo="false">
          <span class="section-number">1.2</span>
          Conditionally Prevents OTA
        </a></li><li>
        <a href="#1.3-AGW-S-002" data-turbo="false">
          <span class="section-number">1.3</span>
          Prevents DoS
        </a></li><li>
        <a href="#1.4-AGW-S-003" data-turbo="false">
          <span class="section-number">1.4</span>
          Prevents Spoofing
        </a></li><li>
        <a href="#1.5-AGW-S-004" data-turbo="false">
          <span class="section-number">1.5</span>
          Prevents Exfiltration
        </a></li><li>
        <a href="#1.6-AGW-S-005" data-turbo="false">
          <span class="section-number">1.6</span>
          Conditionally Prevents Elevation
        </a></li><li>
        <a href="#1.7-AGW-S-006" data-turbo="false">
          <span class="section-number">1.7</span>
          Prevents Data Loss
        </a></li><li>
        <a href="#1.8-AGW-S-007" data-turbo="false">
          <span class="section-number">1.8</span>
          Preserves High Side Operation
        </a></li><li>
        <a href="#1.9-AGW-S-008" data-turbo="false">
          <span class="section-number">1.9</span>
          Security Assurance
        </a></li><li>
        <a href="#1.10-AGW-S-009" data-turbo="false">
          <span class="section-number">1.10</span>
          Preserves Performance
        </a></li><li>
        <a href="#1.11-AGW-S-010" data-turbo="false">
          <span class="section-number">1.11</span>
          Mode Switch Interlock
        </a></li><li>
        <a href="#1.12-AGW-S-011" data-turbo="false">
          <span class="section-number">1.12</span>
          Mode Switch Indicated
        </a></li><li><a href="#1.13-Security-Requirements-for-CAN-Gateways" data-turbo="false">
              <span class="section-number">1.13</span>
              Security Requirements for CAN Gateways
            </a><ul><li>
        <a href="#1.13.1-CGW-S-001" data-turbo="false">
          <span class="section-number">1.13.1</span>
          Performant
        </a></li><li><a href="#1.13.2-Preserves-Atomic-Multicast-CGW-S-005-Series" data-turbo="false">
              <span class="section-number">1.13.2</span>
              Preserves Atomic Multicast: CGW-S-005* Series
            </a><ul><li>
        <a href="#1.13.2.1-CGW-S-005a" data-turbo="false">
          <span class="section-number">1.13.2.1</span>
          Won't Drop Frames
        </a></li><li>
        <a href="#1.13.2.2-CGW-S-005b" data-turbo="false">
          <span class="section-number">1.13.2.2</span>
          No Priority Inversion
        </a></li><li>
        <a href="#1.13.2.3-CGW-S-005c" data-turbo="false">
          <span class="section-number">1.13.2.3</span>
          Preserves Ordering
        </a></li><li>
        <a href="#1.13.2.4-CGW-S-005d" data-turbo="false">
          <span class="section-number">1.13.2.4</span>
          FIFO but Also Priority
        </a></li><li>
        <a href="#1.13.2.5-CGW-S-005e" data-turbo="false">
          <span class="section-number">1.13.2.5</span>
          Preserves Jitter
        </a></li></ul>
            </li><li><a href="#1.13.3-Prevents-CAN-Attacks" data-turbo="false">
              <span class="section-number">1.13.3</span>
              Prevents CAN Attacks
            </a><ul><li>
        <a href="#1.13.3.1-CGW-S-006" data-turbo="false">
          <span class="section-number">1.13.3.1</span>
          Prevents Bus Flood Attacks
        </a></li><li>
        <a href="#1.13.3.2-CGW-S-007" data-turbo="false">
          <span class="section-number">1.13.3.2</span>
          Prevents (Simple) Frame Spoofing
        </a></li><li><a href="#1.13.3.3-Prevents-CAN-Protocol-Attacks-CGW-S-008-Series" data-turbo="false">
              <span class="section-number">1.13.3.3</span>
              Prevents CAN Protocol Attacks: CGW-S-008* Series
            </a><ul><li>
        <a href="#1.13.3.3.1-CGW-S-008a" data-turbo="false">
          <span class="section-number">1.13.3.3.1</span>
          Prevents Adaptive Frame Spoofing
        </a></li><li>
        <a href="#1.13.3.3.2-CGW-S-008b" data-turbo="false">
          <span class="section-number">1.13.3.3.2</span>
          Prevents Error Passive Attack Step
        </a></li><li>
        <a href="#1.13.3.3.3-CGW-S-008c" data-turbo="false">
          <span class="section-number">1.13.3.3.3</span>
          Prevents Double Receive Attack
        </a></li><li>
        <a href="#1.13.3.3.4-CGW-S-008d" data-turbo="false">
          <span class="section-number">1.13.3.3.4</span>
          Prevents Bus-Off Attack
        </a></li><li>
        <a href="#1.13.3.3.5-CGW-S-008e" data-turbo="false">
          <span class="section-number">1.13.3.3.5</span>
          Prevents Freeze Doom Loop Attack
        </a></li></ul>
            </li><li>
        <a href="#1.13.3.4-CGW-S-013" data-turbo="false">
          <span class="section-number">1.13.3.4</span>
          Impervious to Janus Attack
        </a></li></ul>
            </li></ul>
            </li><li><a href="#1.14-Security-Requirements-for-J1939-Gateways" data-turbo="false">
              <span class="section-number">1.14</span>
              Security Requirements for J1939 Gateways
            </a><ul><li>
        <a href="#1.14.1-J1939GW-S-039" data-turbo="false">
          <span class="section-number">1.14.1</span>
          Prevents J1939 Address Spoofing
        </a></li><li>
        <a href="#1.14.2-J1939GW-S-029" data-turbo="false">
          <span class="section-number">1.14.2</span>
          Prevents Address Claim Attacks
        </a></li><li>
        <a href="#1.14.3-J1939GW-S-089" data-turbo="false">
          <span class="section-number">1.14.3</span>
          Impervious to Address Claim Attacks
        </a></li></ul>
            </li></ul>
            </li><li><a href="#2-Security-Requirements-for-Abstract-Unintended-Gateways" data-turbo="false">
              <span class="section-number">2</span>
              Security Requirements for Abstract Unintended Gateways
            </a><ul><li>
        <a href="#2.1-NGW-S-001" data-turbo="false">
          <span class="section-number">2.1</span>
          Security Assurance
        </a></li><li><a href="#2.2-Prevents-Gateway-Functions" data-turbo="false">
              <span class="section-number">2.2</span>
              Prevents Gateway Functions
            </a><ul><li>
        <a href="#2.2.1-NGW-S-002" data-turbo="false">
          <span class="section-number">2.2.1</span>
          Won't Transport
        </a></li><li>
        <a href="#2.2.2-NGW-S-003" data-turbo="false">
          <span class="section-number">2.2.2</span>
          Won't Translate
        </a></li><li>
        <a href="#2.2.3-NGW-S-004" data-turbo="false">
          <span class="section-number">2.2.3</span>
          Won't Filter, Drop or Rate Limit
        </a></li><li>
        <a href="#2.2.4-NGW-S-005" data-turbo="false">
          <span class="section-number">2.2.4</span>
          Won't Encapsulate
        </a></li></ul>
            </li></ul>
            </li></ul>
</turbo-frame>

    </aside>

    
  <a class="layout_toggler layout_button" id="layout_toggle"></a><nav class="layout_nav">
    <a
    class="layout_nav-btn layout_button btn-document"
    title="Go to Document view"
    href="../vcr-experiment/01_gateways.html">
    DOC
  </a>
  <a
    class="layout_nav-btn layout_button btn-table"
    title="Go to Table view"
    href="../vcr-experiment/01_gateways-TABLE.html">
    TBL
  </a>
  <a
    class="layout_nav-btn layout_button btn-traceability"
    title="Go to Traceability view"
    href="../vcr-experiment/01_gateways-TRACE.html">
    TR
  </a>
  <a
    class="layout_nav-btn layout_button btn-deep-traceability"
    title="Go to Deep Traceability view"
    href="../vcr-experiment/01_gateways-DEEP-TRACE.html">
    DTR
  </a>
  </nav>


    <header class="layout_header">
      
  <p>Vehicle Network Gateway Devices Security Requirements <span class="document-view-type">Deep Traceability</span></p>

    </header>

    <main class="layout_main" id="pan-with-space">
      

      <div class="tags">
  <span class="tag">
    CONTAINS_OPTIONS<span class="tag_badge">2</span>
  </span>
</div>

      <div class="content">
          <section class="content_section">
            <div class="content_item" data-role="current"><turbo-frame id="article-8271dcdd13e441f1bc2bd24785607954"><article class="docsection" data-controller="document">

  <section data-section="meta" class="docsection_section">

    <div data-role='anchor' id="1-Security-Requirements-for-Abstract-Intended-Gateways"></div>

    
        <h1
class="section-title"
data-level="1">
  1.&nbsp;Security Requirements for Abstract (Intended) Gateways
</h1>
    

  </section>

  <section data-section="description" class="docsection_section"><div class="free-text">
      <div class="document">
<p>The following requirements must be satisfied by any device intended to be a gateway on <em>any type of</em> vehicle networks. There are CAN-specific and J1939-sepcific requirements in the CGW- and J1939GW- series below.</p>
</div>

    </div></section></article>

</turbo-frame></div>
          </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">
</div>
          <div class="content_item" data-role="current"><turbo-frame id="article-04e16c17876e4067a657ac70384298e6"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.1-AGW-S-000"></div>
    <h2
class="section-title"
data-level="1.1">
  1.1.&nbsp;Gateway Configuration Protected
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-000</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL accept and react only to configuration changes which are correctly authorized and authenticated, regardless of origin of network domain.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    <div class="requirement_comment">
      <div class="document">
<p>This can be achieved by use of a Hardware Security Module (HSM) containing keys for verifying a configuration using a secure message authentication code (MAC) and where the HSM has a secure mechanism for remotely programming the MAC key.</p>
</div>

    </div>
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul>
<li><p class="first"><a class="reference external" href="https://www.autosar.org/fileadmin/user_upload/standards/foundation/19-11/AUTOSAR_TR_SecureHardwareExtensions.pdf">https://www.autosar.org/fileadmin/user_upload/standards/foundation/19-11/AUTOSAR_TR_SecureHardwareExtensions.pdf</a> for an example of a suitable HSM (the SHE+ HSM).</p>
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Mechanisms that effectively secure maintenance operations, including both diagnostic procedures and update procedures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, g.</p>
</blockquote>
</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that replay of traffic for a valid configuration change, on any interface, does not result in any configuration changes to the device.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">
</div>
          <div class="content_item" data-role="current"><turbo-frame id="article-2c818aff583d4dcd9da42929af640c32"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.2-AGW-S-001"></div>
    <h2
class="section-title"
data-level="1.2">
  1.2.&nbsp;Conditionally Prevents OTA
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-001</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent Over The Air updates (OTA) (including parameter flash) from <em>UND</em> to <em>TND</em>, unless with explicitly authorized and authenticated configuration changes via the mode switch.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Mechanisms that effectively secure maintenance operations, including both diagnostic procedures and update procedures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, g.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<dl class="docutils">
<dt>Test to confirm that both:</dt>
<dd><ol class="first last arabic simple">
<li>OTA and parameter reflash are permitted from UND to TND when the mode switch is set to allow</li>
<li>OTA and parameter reflash are _prevented_ from UND to TND when the mode switch is not set to allow</li>
</ol>
</dd>
</dl>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">
</div>
          <div class="content_item" data-role="current"><turbo-frame id="article-0c9ee1effe34491798ecd40f21edcd47"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.3-AGW-S-002"></div>
    <h2
class="section-title"
data-level="1.3">
  1.3.&nbsp;Prevents DoS
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-002</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.1-CGW-S-006">
      <span class="requirement_child-uid">CGW-S-006</span>
      Prevents Bus Flood Attacks
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.4-CGW-S-008d">
      <span class="requirement_child-uid">CGW-S-008d</span>
      Prevents Bus-Off Attack
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.5-CGW-S-008e">
      <span class="requirement_child-uid">CGW-S-008e</span>
      Prevents Freeze Doom Loop Attack
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.14.2-J1939GW-S-029">
      <span class="requirement_child-uid">J1939GW-S-029</span>
      Prevents Address Claim Attacks
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating Denial of Service (DoS) on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>It is recommended to isolate safety-critical ECUs on their own CAN bus, with some sort of gateway between them and other ECUs</p>
<p class="attribution">&mdash;FMCSA GDL 37</p>
</blockquote>
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that denying access to the UND medium has no effect on TND performance.</p>
<p>AND</p>
<p>Test to confirm that for each permitted UND-&gt;TND transport, translation or encapsulation by the gateway: that sending the highest rate of traffic from UND to TND with it (one of the transport, translation or encapsulation) does not cause any performance degradation to the target device(s), nor TND in its entirety.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">

<ul class="requirement-tree requirement-tree_right"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-2570eb6ffadf454f8995295b98bbff00"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.1-CGW-S-006"></div>
    <h4
class="section-title"
data-level="1.13.3.1">
  1.13.3.1.&nbsp;Prevents Bus Flood Attacks
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-006</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.3-AGW-S-002">
      <span class="requirement_parent-uid">AGW-S-002</span>
      Prevents DoS
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating bus flood attacks on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.1 for a description of the bus flood attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that, for both permitted and prevented UND-&gt;TND transport, translation or encapsulation by the gateway: that sending the highest rate of traffic on UND does not result in transmit at the highest rate on TND.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-90468492a75b4445b6b672eeba91e171"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.3.4-CGW-S-008d"></div>
    <h5
class="section-title"
data-level="1.13.3.3.4">
  1.13.3.3.4.&nbsp;Prevents Bus-Off Attack
</h5>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-008d</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.3-AGW-S-002">
      <span class="requirement_parent-uid">AGW-S-002</span>
      Prevents DoS
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating bus-off attacks on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.6 for a description of the bus-off attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that the (gateway) device does not permit direct (GPIO-like) control of the TND CAN bus from UND (e.g. anything other than direct-wiring). In all other cases the separation of UND and TND will preclude the possibility of a bus off attack.</p>
<p>AND</p>
<p>Inspection of vendor documentation to confirm that the (gateway) device is not implemented with SoC-integrated CAN controllers whose pins can be multiplexed with GPIOs. OR To confirm that the device software has very high security assurance to guarantee that malicious software could never control the GPIOs or the pinmuxing.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-fae1fd80dc34404fb81f733b61edb75f"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.3.5-CGW-S-008e"></div>
    <h5
class="section-title"
data-level="1.13.3.3.5">
  1.13.3.3.5.&nbsp;Prevents Freeze Doom Loop Attack
</h5>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-008e</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.3-AGW-S-002">
      <span class="requirement_parent-uid">AGW-S-002</span>
      Prevents DoS
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating freeze doom loop attacks on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.7 for a description of the freeze doom loop attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that the (gateway) device does not permit direct (GPIO-like) control of the TND CAN bus from UND (e.g. anything other than direct-wiring). In all other cases the separation of UND and TND will preclude the possibility of a freeze doom loop attack</p>
<p>AND</p>
<p>Inspection of vendor documentation to confirm that the (gateway) device is not implemented with SoC-integrated CAN controllers whose pins can be multiplexed with GPIOs. OR To confirm that the device software has very high security assurance to guarantee that malicious software could never control the GPIOs or the pinmuxing.</p>
<p>AND</p>
<p>Inspection of design artifacts or a third party analysis to confirm that there is no possible CAN frames on UND that will result in CAN frames on TND that would match any arbitration IDs sent by nodes on TND. Otherwise there is a non-zero probability that the gateway's TND CAN controller could enter a freeze doom loop with a node on TND.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-9b3d7c788d984a27b690e130455345d2"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.14.2-J1939GW-S-029"></div>
    <h3
class="section-title"
data-level="1.14.2">
  1.14.2.&nbsp;Prevents Address Claim Attacks
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>J1939GW-S-029</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.3-AGW-S-002">
      <span class="requirement_parent-uid">AGW-S-002</span>
      Prevents DoS
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating address claim attacks on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    <div class="requirement_comment">
      <div class="document">
<p><strong>Note to implementors</strong>: Performing no gatewaying (any of transport, translate, filter, or encapsulate) of address claims onto <em>TND</em> would satisfy this requirement.</p>
</div>

    </div>
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://www.aut.upt.ro/~bgroza/Papers/j1939.pdf">https://www.aut.upt.ro/~bgroza/Papers/j1939.pdf</a> and <a class="reference external" href="https://doi.org/10.4271/02-14-03-0026">https://doi.org/10.4271/02-14-03-0026</a> for a description of the address claim attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that for all source addresses claimed on TND, no address claims can be sent from UND for that address regardless of permitted transports, translations or encapsulations configured.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">
</div>
          <div class="content_item" data-role="current"><turbo-frame id="article-ac1d5ece086f4b1b84d6dce31186fceb"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.4-AGW-S-003"></div>
    <h2
class="section-title"
data-level="1.4">
  1.4.&nbsp;Prevents Spoofing
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-003</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.2-CGW-S-007">
      <span class="requirement_child-uid">CGW-S-007</span>
      Prevents (Simple) Frame Spoofing
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.1-CGW-S-008a">
      <span class="requirement_child-uid">CGW-S-008a</span>
      Prevents Adaptive Frame Spoofing
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.14.1-J1939GW-S-039">
      <span class="requirement_child-uid">J1939GW-S-039</span>
      Prevents J1939 Address Spoofing
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent spoofing/masquerading/injection onto <em>TND</em></p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>It is recommended to isolate safety-critical ECUs on their own CAN bus, with some sort of gateway between them and other ECUs</p>
<p class="attribution">&mdash;FMCSA GDL 37</p>
</blockquote>
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that for each permitted UND-&gt;TND transport, translation or encapsulation by the gateway: that sending traffic from UND to TND with it (one of the transport, translation or encapsulation) does not cause any traffic that will be interpreted by any nodes in TND as being traffic that originated from a node in a TND.</p>
<p>AND</p>
<p>Inspection of design artifacts or a third party analysis to confirm that there is no possible traffic on UND that will result in traffic on TND that would be interpreted by any nodes in TND as being traffic that originated from a node in a TND.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">

<ul class="requirement-tree requirement-tree_right"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-81ee81d7949b42d59c5528349dd4b4f5"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.2-CGW-S-007"></div>
    <h4
class="section-title"
data-level="1.13.3.2">
  1.13.3.2.&nbsp;Prevents (Simple) Frame Spoofing
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-007</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.4-AGW-S-003">
      <span class="requirement_parent-uid">AGW-S-003</span>
      Prevents Spoofing
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating simple frame spoofing attacks on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.2 for a description of simple frame spoofing attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that for each permitted UND-&gt;TND transport, translation or encapsulation by the gateway: that sending CAN frames from UND to TND with it (one of the transport, translation or encapsulation) does not cause any CAN frames that will be interpreted by any nodes in TND as being traffic that originated from a node in a TND.</p>
<p>AND</p>
<p>Inspection of design artifacts or a third party analysis to confirm that there is no possible CAN frames on UND that will result in CAN frames on TND that would be interpreted by any nodes in TND as being traffic that originated from a node in a TND.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-493a55841b22424a87c70c90fdb7875d"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.3.1-CGW-S-008a"></div>
    <h5
class="section-title"
data-level="1.13.3.3.1">
  1.13.3.3.1.&nbsp;Prevents Adaptive Frame Spoofing
</h5>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-008a</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.4-AGW-S-003">
      <span class="requirement_parent-uid">AGW-S-003</span>
      Prevents Spoofing
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating adaptive frame spoofing attacks on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.3 for a description of adaptive frame spoofing attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that the (gateway) device is not implemented using direct-wired transceivers from TND to UND. In all other cases the delays introduced by the gateway will implicitly prevent Adaptive Frame Spoofing Attacks.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-1f047de2ed8e4a61a4260b54e833622c"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.14.1-J1939GW-S-039"></div>
    <h3
class="section-title"
data-level="1.14.1">
  1.14.1.&nbsp;Prevents J1939 Address Spoofing
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>J1939GW-S-039</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>Medium</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.4-AGW-S-003">
      <span class="requirement_parent-uid">AGW-S-003</span>
      Prevents Spoofing
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device shall prevent the gatewaying (any of transport, translate, filter, or encapsulate) of any traffic onto <em>TND</em> with a J1939 address which is claimed by any of the devices in <em>TND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that for all source addresses claimed on TND, sending J1939 frames with any such source address is prevented from being transported, translated or encapsulated by the gateway to the TND; regardless of  permitted UND-&gt;TND transport, translation or encapsulation mechanisms that maybe configured on the gateway.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">
</div>
          <div class="content_item" data-role="current"><turbo-frame id="article-10ec33d167d2411dbdf72bc87dccde57"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.5-AGW-S-004"></div>
    <h2
class="section-title"
data-level="1.5">
  1.5.&nbsp;Prevents Exfiltration
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-004</dd>
    
    <dt><i>TAGS</i></dt>
    <dd>CONTAINS_OPTIONS</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent exfiltration of data from <em>TND</em> to <em>UND</em>, or vice-versa, by satisfying one or more of these methods:</p>
<ul class="simple">
<li>Protect Confidentiality: These devices MAY encapsulate and/or translate (e.g. encrypt) information as it is transported between the network domains for the purposes of protecting confidentiality of the information in the domain to which the information is moved.</li>
<li>Re-Write / Masking: The device SHALL provide a means of masking or otherwise re-writing data to prevent exfiltration of sensitive information from <em>TND</em> to <em>UND</em>.</li>
</ul>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Access control mechanisms that tend to restrict access to information about the operational state of the vehicle, privacy sensitive information, financially sensitive information, detailed design information, etc.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, c.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that for each permitted TND-&gt;UND transport, translation or encapsulation by the gateway and for each information in TND that is configured for confidentiality protection or masking: that canary values sent on TND do not show up in any traffic on UND.</p>
<p>AND</p>
<p>For non-masking: Inspection of a 3rd party implementation review report or a demonstration by the vendor that asserts the use of cryptographic protections for the confidentiality and integrity of all external communications channels. The cryptographic protections must be industry standard.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">
</div>
          <div class="content_item" data-role="current"><turbo-frame id="article-75feccdbcb2f4b6784316f682a210bdb"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.6-AGW-S-005"></div>
    <h2
class="section-title"
data-level="1.6">
  1.6.&nbsp;Conditionally Prevents Elevation
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-005</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent abuse of <em>TND</em> network domain functionality from <em>UND</em> to <em>TND</em>, unless with explicitly authorized and authenticated configuration changes via the mode switch.</p>
<p>The specifics of what <em>TND</em> network domain functionality could be abused will depend on what is implemented in the vehicle networks. Examples of vehicle network functionality which could be abused in passenger cars is captured in the J3138 &quot;intrusive services&quot; it lists: e.g. <em>Request control of on-board system, test or component</em>, <em>ECUProgrammingSession</em>, <em>ECUReset</em>, <em>WriteByIdentifier</em>, etc.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>It is recommended to isolate safety-critical ECUs on their own CAN bus, with some sort of gateway between them and other ECUs</p>
<p class="attribution">&mdash;FMCSA GDL 37</p>
</blockquote>
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Central gateway or domain controller based architectures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, e.</p>
</blockquote>
<ul class="simple">
<li>Example <em>Intrusive Services</em>, SAE J3138.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that TND functionality prevented when the mode switch is set to disabled includes all the known critical and dangerous features of the vehicle TND in question. E.g. that diagnostics and influence of vehicle uptime are prevented when the mode switch is set to disabled.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">
</div>
          <div class="content_item" data-role="current"><turbo-frame id="article-61d08e73c6c245cf85806b6a5cd6e6ed"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.7-AGW-S-006"></div>
    <h2
class="section-title"
data-level="1.7">
  1.7.&nbsp;Prevents Data Loss
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-006</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent all data loss and/or corruption of information in the bidirectional <em>UND</em> &lt;-&gt; <em>TND</em> operation, unless with explicit configuration for rate limiting (AGW-F-006) or translation (AGW-F-002).</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor reliability testing reports to confirm that the device will not cause data loss or corruption at sustained loads of expected maximum traffic on TND and UND.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">
</div>
          <div class="content_item" data-role="current"><turbo-frame id="article-f6e8582066054d628c67fe60d6165a63"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.8-AGW-S-007"></div>
    <h2
class="section-title"
data-level="1.8">
  1.8.&nbsp;Preserves High Side Operation
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-007</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.10-AGW-S-009">
      <span class="requirement_child-uid">AGW-S-009</span>
      Preserves Performance
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.1-CGW-S-005a">
      <span class="requirement_child-uid">CGW-S-005a</span>
      Won't Drop Frames
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.2-CGW-S-005b">
      <span class="requirement_child-uid">CGW-S-005b</span>
      No Priority Inversion
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.3-CGW-S-005c">
      <span class="requirement_child-uid">CGW-S-005c</span>
      Preserves Ordering
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.4-CGW-S-005d">
      <span class="requirement_child-uid">CGW-S-005d</span>
      FIFO but Also Priority
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.5-CGW-S-005e">
      <span class="requirement_child-uid">CGW-S-005e</span>
      Preserves Jitter
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.2-CGW-S-008b">
      <span class="requirement_child-uid">CGW-S-008b</span>
      Prevents Error Passive Attack Step
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.3-CGW-S-008c">
      <span class="requirement_child-uid">CGW-S-008c</span>
      Prevents Double Receive Attack
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent degradation of any <em>TND</em> operation due to <em>UND</em> activity.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Central gateway or domain controller based architectures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, e.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">

<ul class="requirement-tree requirement-tree_right"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-7247e22458e24bdbb2227aae376e5c6c"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.10-AGW-S-009"></div>
    <h2
class="section-title"
data-level="1.10">
  1.10.&nbsp;Preserves Performance
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-009</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>Medium</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.1-CGW-S-001">
      <span class="requirement_child-uid">CGW-S-001</span>
      Performant
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL be scoped to sufficient detail to preserve network domain performance guarantees in <em>TND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor reliability testing reports to confirm that the device will not cause loss of performance in TND.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>

<ul class="requirement-tree requirement-tree_right"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-30554e3dd00a486e996bb11d883ebdd4"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.1-CGW-S-001"></div>
    <h3
class="section-title"
data-level="1.13.1">
  1.13.1.&nbsp;Performant
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-001</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>Medium</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.10-AGW-S-009">
      <span class="requirement_parent-uid">AGW-S-009</span>
      Preserves Performance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL process and move CAN frames quickly enough to preserve performance on all network domains.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor reports to confirm that performance is sufficient for all vehicle TNDs.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul>

  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-77908eed4ac4469caef657aff6a2a115"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.2.1-CGW-S-005a"></div>
    <h4
class="section-title"
data-level="1.13.2.1">
  1.13.2.1.&nbsp;Won't Drop Frames
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-005a</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL NOT drop CAN frames in its bidirectional <em>UND</em> &lt;-&gt; <em>TND</em> operation, unless with explicit configuration for rate limiting or translating.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor reports to confirm that CAN frames are, by design, not dropped.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-027903bd54354baa94861480c94e0bc4"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.2.2-CGW-S-005b"></div>
    <h4
class="section-title"
data-level="1.13.2.2">
  1.13.2.2.&nbsp;No Priority Inversion
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-005b</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL schedule egress frames according to the CAN arbitration ID priority in its bidirectional <em>UND</em> &lt;-&gt; <em>TND</em> operation, to prevent priority inversion.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that device's implementation follows the rules for CAN arbitration ID priority and the prevention of priority inversion.</p>
<p>AND</p>
<p>Inspection of vendor report detailing the use of a test environment that simulates a bidirectional UND &lt;-&gt; TND operation, with different arbitration ID priorities. Where, with the test environment set up, a CAN analyzer or other monitoring tool was used to observe the device's scheduling of egress frames and verify that it followed the correct arbitration ID priority: that higher-priority frames are always transmitted before lower-priority frames. The test methodoly described in the report should be comparable to the following:</p>
<pre class="literal-block">
   +---------+                                      +---------+
   |         |                                      |         |
   | Monitor |                                      | Monitor |
   |         |                                      |         |
   +---+-----+          +--------------+            +---+-----+
+-+    |        UND     |              |    TND         |       +-+
|+|    |                |   Security   |                |       |+|
|++----+----------+-----+    Gateway   +-------+--------+-------++|
|+|               |     |              |       |                |+|
+-+               |     +--------------+       |                +-+
                  |                            |
                  |                            |
                  |        +--------+          |
                  |        |        |          |
                  +--------+ Tester +----------+
                           |        |
                           +--------+
</pre>
<p>Figure 1</p>
<p>The hardware setup is shown in Figure 1. The device under test (Security gateway) is connected to an untrusted network and a trusted network. A tester is connected to both networks and on each there is a monitor. The monitor is set up to receive traffic and acknowledge CAN frames.</p>
<p>The tester operates a frame transmission process on the Trusted network. This performs the following steps:</p>
<ol class="arabic">
<li><p class="first">Wait until frame with ID 0x010 is seen on the Trusted network.</p>
</li>
<li><p class="first">Queue in FIFO order on the Trusted bus CAN frames with the following IDs (’S’ indicates a standard 11-bit CAN ID):</p>
<ul class="simple">
<li>0x005 (S)</li>
<li>0x006 (S)</li>
</ul>
<p>and repeat this queueing of the IDs until the process is stopped.</p>
</li>
</ol>
<p>The time between steps 1 and 2 must be less than 50 microseconds (i.e. much shorter than a CAN frame transmission time).</p>
<p>The frames must be queued such that no idle time can appear between them. This is achieved by queueing the first frame and then immediately the second frame. When the first frame is transmitted then the third frame is queued. When the second frame is transmitted then the fourth frame is queued. And so on.</p>
<p>The main test process is carried out in the following steps:</p>
<ol class="arabic">
<li><p class="first">The tester queues in FIFO order on the Untrusted network CAN frames with the following IDs:</p>
<ul class="simple">
<li>0x010 (S)</li>
<li>0x011 (S)</li>
<li>0x00240000 (E)</li>
<li>0x008 (S)</li>
<li>0x001c0000 (E)</li>
<li>0x00100000 (E)</li>
<li>0x003 (S)</li>
<li>0x00080000 (E)</li>
<li>0x001 (S)</li>
</ul>
<p>,where ’S’ indicates a standard 11-bit CAN ID, ‘E’ indicates an extended 29-bit CAN ID.</p>
<p>The security gateway is programmed to allow these frames through from the Untrusted to the Trusted bus.</p>
<p>The frames are queued such that there is no idle time between them (using the technique described above).</p>
</li>
<li><p class="first">When the frame with ID 0x00100000 is seen on the Trusted bus then Trusted network process above is halted. If the frame is never seen then the Security gateway has failed the test.</p>
<p>The sequence of frames seen by the Monitor on the Untrusted bus should be:</p>
<ul class="simple">
<li>0x010 (S)</li>
<li>0x011 (S)</li>
<li>0x00240000 (E)</li>
<li>0x008 (S)</li>
<li>0x001c0000 (E)</li>
<li>0x00100000 (E)</li>
<li>0x003 (S)</li>
<li>0x00080000 (E)</li>
<li>0x001 (S)</li>
</ul>
<p>If this sequence is not seen then there is a fault in the tester.</p>
<p>The sequence of frames seen by the Monitor on the Trusted bus should be:</p>
<ul class="simple">
<li>0x010 (S)</li>
<li>0x005 (S)</li>
<li>0x006 (S)
… (0x005 and 0x006 repeated for some number of times, the exact number depending on the speed of either bus and the payloads used for the frames)</li>
<li>0x001 (S)</li>
<li>0x00080000 (E)</li>
<li>0x003 (S)</li>
<li>0x00100000 (E)</li>
<li>0x005 (S)</li>
<li>0x006 (S)
… (0x005 and 0x006 may appear again, depending on how long it takes for the tester to halt the Trusted network process)</li>
<li>0x001c0000 (E)</li>
<li>0x008 (S)</li>
<li>0x00240000 (E)</li>
<li>0x011 (S)</li>
</ul>
<p>If the sequence seen by the Monitor deviates from the above then the Security gateway has failed the test.</p>
</li>
</ol>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-8293564651414e67a72b48ca59b76012"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.2.3-CGW-S-005c"></div>
    <h4
class="section-title"
data-level="1.13.2.3">
  1.13.2.3.&nbsp;Preserves Ordering
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-005c</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL preserve ordering egress frames with respect to their ingress order within an equivalence class of CAN arbitration ID priorities, to prevent out-of-order delivery.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that the device is NOT implemented using SocketCAN -- SocketCAN drivers will randomly switch order of frames at both the same arbitration ID and among varied arbitration IDs.</p>
<p>AND</p>
<p>Inspection of vendor report detailing the use of a test environment that simulates a bidirectional UND &lt;-&gt; TND operation, with multiple nodes transmitting frames with different arbitration ID priorities. Where, with the test environment set up, a CAN analyzer or other monitoring tool was used to observe the device's scheduling of egress frames and verify that it followed the correct ordering within the same arbitration IDs: that frames are sent in the order received within the same arbitration ID.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-8f95ec2837a34fd983ef6730cd638cc8"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.2.4-CGW-S-005d"></div>
    <h4
class="section-title"
data-level="1.13.2.4">
  1.13.2.4.&nbsp;FIFO but Also Priority
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-005d</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL schedule egress for in-order send but not across CAN arbitration ID priorities.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor report detailing the use of a test environment that simulates a bidirectional UND &lt;-&gt; TND operation, with multiple nodes transmitting frames with different arbitration ID priorities. Where, with the test environment set up, a CAN analyzer or other monitoring tool was used to observe the device's scheduling of egress frames and verify that it followed the correct ordering within the same arbitration IDs: that frames are sent in the order received within the same arbitration ID but that also priority of arbitration IDs are respected.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-617eaf2e64ab427da0f1094529dc0f15"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.2.5-CGW-S-005e"></div>
    <h4
class="section-title"
data-level="1.13.2.5">
  1.13.2.5.&nbsp;Preserves Jitter
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-005e</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>Medium</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL have ingress-to-egress latency variability (jitter) low enough to not affect the <em>TND</em> network domain performance requirements in the worst case.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor report detailing the use of a test environment that simulates a network load to measure jitter of the device. Where, with the test environment set up, a CAN analyzer or other monitoring tool was used to observe the device's scheduling of egress frames and verify the jitter introduced. The test methodoly described in the report should be comparable to the following:</p>
<pre class="literal-block">
   +---------+                                      +---------+
   |         |                                      |         |
   | Monitor |                                      | Monitor |
   |         |                                      |         |
   +---+-----+          +--------------+            +---+-----+
+-+    |        UND     |              |    TND         |       +-+
|+|    |                |   Security   |                |       |+|
|++----+----------+-----+    Gateway   +-------+--------+-------++|
|+|               |     |              |       |                |+|
+-+               |     +--------------+       |                +-+
                  |                            |
                  |                            |
                  |        +--------+          |
                  |        |        |          |
                  +--------+ Tester +----------+
                           |        |
                           +--------+
</pre>
<p>Figure 1</p>
<p>The security gateway is configured to allow a test frame through the security gateway. Both the Untrusted and Trusted networks are free of any other traffic. Monitor units are set up to listen to and acknowledge CAN frames.</p>
<p>The tester checks for jitter removal by injecting a sequence of periodic frames on to the Untrusted network and measuring the timing of frames on the Trusted network.</p>
<p>In the tester, a send process is defined to run from a periodic timer event set to 100ms:</p>
<ol class="arabic simple">
<li>Wait for timing event</li>
<li>Delay for a time t</li>
<li>Queue a frame in the CAN controller connected to the Untrusted network</li>
</ol>
<p>The tester must complete the queueing of the CAN frame within 5 microseconds of the timer delay.</p>
<p>Repeat steps 1 to 3 for a sequence of values of t. The values of t should be as follows:</p>
<ul class="simple">
<li>0.5ms</li>
<li>99.0ms</li>
<li>0.5ms</li>
<li>80.0ms</li>
<li>0.5ms</li>
<li>70.0ms</li>
<li>0.5ms</li>
<li>60.0ms</li>
<li>0.5ms</li>
<li>50.0ms</li>
<li>60.0ms</li>
<li>70.0ms</li>
<li>80.0ms</li>
<li>90.0ms</li>
<li>90.0ms</li>
</ul>
<p>The tester should take accurate (1 microsecond) start-of-frame (SOF) timestamps for each CAN frame on the Trusted network.</p>
<p>The test fails if a total of 15 frames were not received from the Trusted network.</p>
<p>The test fails if time between the SOF timestamp of the first frame received and the SOF timestamp of the last frame received exceeds 1490.055ms or is less than 1489.945ms.</p>
<p>The test fails if the difference between the SOF timestamp of a frame and its subsequent frame exceeds 100.055ms or is less than 99.945ms.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-2c2711b3632348b4943ddd0f8a49058c"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.3.2-CGW-S-008b"></div>
    <h5
class="section-title"
data-level="1.13.3.3.2">
  1.13.3.3.2.&nbsp;Prevents Error Passive Attack Step
</h5>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-008b</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating attacks that drive a ECU on <em>TND</em> into error passive state from messages originating on <em>UND</em>. This will in turn prevent error passive spoofing attacks.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.4 for a description of error passive spoofing attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that the (gateway) device does not permit direct (GPIO-like) control of the TND CAN bus from UND (e.g. anything other than direct-wiring). In all other cases the separation of UND and TND will preclude the possibility of an error passive attack step.</p>
<p>AND</p>
<p>Inspection of vendor documentation to confirm that the (gateway) device is not implemented with SoC-integrated CAN controllers whose pins can be multiplexed with GPIOs. OR To confirm that the device software has very high security assurance to guarantee that malicious software could never control the GPIOs or the pinmuxing.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-758d05e97c304f698efcf2a57602173e"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.3.3-CGW-S-008c"></div>
    <h5
class="section-title"
data-level="1.13.3.3.3">
  1.13.3.3.3.&nbsp;Prevents Double Receive Attack
</h5>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-008c</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating double receive attacks on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.5 for a description of the double receive attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that the (gateway) device does not permit direct (GPIO-like) control of the TND CAN bus from UND (e.g. anything other than direct-wiring). In all other cases the separation of UND and TND will preclude the possibility of a double receive attack.</p>
<p>AND</p>
<p>Inspection of vendor documentation to confirm that the (gateway) device is not implemented with SoC-integrated CAN controllers whose pins can be multiplexed with GPIOs. OR To confirm that the device software has very high security assurance to guarantee that malicious software could never control the GPIOs or the pinmuxing.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">
</div>
          <div class="content_item" data-role="current"><turbo-frame id="article-6c5dc5c658724c7898e18edf0a28ef1a"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.9-AGW-S-008"></div>
    <h2
class="section-title"
data-level="1.9">
  1.9.&nbsp;Security Assurance
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-008</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.4-CGW-S-013">
      <span class="requirement_child-uid">CGW-S-013</span>
      Impervious to Janus Attack
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.14.3-J1939GW-S-089">
      <span class="requirement_child-uid">J1939GW-S-089</span>
      Impervious to Address Claim Attacks
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL satisfy a comprehensive set of product security requirements to yield high assurance of correct operation in the face of adversarial inputs to the device.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms that tend to restrict access to information about the operational state of the vehicle, privacy sensitive information, financially sensitive information, detailed design information, etc.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, c.</p>
</blockquote>
<blockquote>
<p>Mechanisms that effectively secure maintenance operations, including both diagnostic procedures and update procedures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, g.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of a third party report to confirm that the device has no known vulnerabilities that could undermine the preventions listed previously, the security requirements of this series, or other the security requirements of derivative series.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">

<ul class="requirement-tree requirement-tree_right"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-c2b2c5d05e594e8ab9c64b261e0932c3"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.4-CGW-S-013"></div>
    <h4
class="section-title"
data-level="1.13.3.4">
  1.13.3.4.&nbsp;Impervious to Janus Attack
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-013</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>Medium</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.9-AGW-S-008">
      <span class="requirement_parent-uid">AGW-S-008</span>
      Security Assurance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL not enable Janus Attacks in any group of OEM supplied components on any of its interfaces.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    <div class="requirement_comment">
      <div class="document">
<p>Susceptibility to Janus Attacks is a property of a network of devices, not only of a single device. The entire <em>TND</em> is expected to be impervious to Janus Attacks since it should all be OEM supplied components there. In <em>UND</em> it is not possible to require that this device nor all the devices are impervious to Janus Attacks since <em>UND</em> is explicitly permitted to contain non-OEM supplied components. What is required of this device on <em>UND</em> is that if there are other OEM supplied devices on <em>UND</em> then this device cannot enable Janus Attacks on that collection of all those OEM supplied devices on <em>UND</em>.</p>
</div>

    </div>
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://kentindell.github.io/2021/07/15/janus-attack/">https://kentindell.github.io/2021/07/15/janus-attack/</a> for a description of the Janus Attack</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor report to confirm that all devices on TND have been tested to demonstrate the same configured CAN sampling point.</p>
<p>AND</p>
<p>Inspection of vendor report to confirm that all original devices on UND have been tested to demonstrate the same configured CAN sampling point.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-2931e5eb0881479db7e81c09fdc1cc55"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.14.3-J1939GW-S-089"></div>
    <h3
class="section-title"
data-level="1.14.3">
  1.14.3.&nbsp;Impervious to Address Claim Attacks
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>J1939GW-S-089</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.9-AGW-S-008">
      <span class="requirement_parent-uid">AGW-S-008</span>
      Security Assurance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL not be susceptible to address claim attacks on any of its interfaces (e.g. <em>TND</em> and <em>UND</em>)</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://www.aut.upt.ro/~bgroza/Papers/j1939.pdf">https://www.aut.upt.ro/~bgroza/Papers/j1939.pdf</a> and <a class="reference external" href="https://doi.org/10.4271/02-14-03-0026">https://doi.org/10.4271/02-14-03-0026</a> for a description of the address claim attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that mitigations against address claim attacks are implemented on all of the interfaces of the device.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-f6e8582066054d628c67fe60d6165a63"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.8-AGW-S-007"></div>
    <h2
class="section-title"
data-level="1.8">
  1.8.&nbsp;Preserves High Side Operation
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-007</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.10-AGW-S-009">
      <span class="requirement_child-uid">AGW-S-009</span>
      Preserves Performance
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.1-CGW-S-005a">
      <span class="requirement_child-uid">CGW-S-005a</span>
      Won't Drop Frames
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.2-CGW-S-005b">
      <span class="requirement_child-uid">CGW-S-005b</span>
      No Priority Inversion
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.3-CGW-S-005c">
      <span class="requirement_child-uid">CGW-S-005c</span>
      Preserves Ordering
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.4-CGW-S-005d">
      <span class="requirement_child-uid">CGW-S-005d</span>
      FIFO but Also Priority
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.5-CGW-S-005e">
      <span class="requirement_child-uid">CGW-S-005e</span>
      Preserves Jitter
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.2-CGW-S-008b">
      <span class="requirement_child-uid">CGW-S-008b</span>
      Prevents Error Passive Attack Step
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.3-CGW-S-008c">
      <span class="requirement_child-uid">CGW-S-008c</span>
      Prevents Double Receive Attack
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent degradation of any <em>TND</em> operation due to <em>UND</em> activity.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Central gateway or domain controller based architectures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, e.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-7247e22458e24bdbb2227aae376e5c6c"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.10-AGW-S-009"></div>
    <h2
class="section-title"
data-level="1.10">
  1.10.&nbsp;Preserves Performance
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-009</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>Medium</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.1-CGW-S-001">
      <span class="requirement_child-uid">CGW-S-001</span>
      Performant
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL be scoped to sufficient detail to preserve network domain performance guarantees in <em>TND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor reliability testing reports to confirm that the device will not cause loss of performance in TND.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">

<ul class="requirement-tree requirement-tree_right"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-30554e3dd00a486e996bb11d883ebdd4"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.1-CGW-S-001"></div>
    <h3
class="section-title"
data-level="1.13.1">
  1.13.1.&nbsp;Performant
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-001</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>Medium</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.10-AGW-S-009">
      <span class="requirement_parent-uid">AGW-S-009</span>
      Preserves Performance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL process and move CAN frames quickly enough to preserve performance on all network domains.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor reports to confirm that performance is sufficient for all vehicle TNDs.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">
</div>
          <div class="content_item" data-role="current"><turbo-frame id="article-b2d388947ae844118f8c5d0ab1e9621b"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.11-AGW-S-010"></div>
    <h2
class="section-title"
data-level="1.11">
  1.11.&nbsp;Mode Switch Interlock
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-010</dd>
    
    <dt><i>TAGS</i></dt>
    <dd>CONTAINS_OPTIONS</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL have a means to temporarily disable the preventions listed previously and as noted with &quot;unless with explicity authorized and authenticated configuration changes via the mode switch&quot; The means must be impossible to use without explicit authorization by the vehicle owner. The device SHALL satisfy one or more of these methods to enable a switch into modes which allow OTA, spoofing, etc. from <em>UND</em> to <em>TND</em>. If more than one is satisfied then the effects of either switch could be in effect concurrently (i.e. a logical OR operation).</p>
<ul class="simple">
<li>Physical Mode Switch Interlock: The device SHALL have at least one physical input that when grounded enables a switch into modes which allow OTA, spoofing, etc. from <em>UND</em> to <em>TND</em>.<ul>
<li>Example: Physical switch on dash</li>
</ul>
</li>
<li>Virtual Mode Switch Interlock: The device SHALL allow a explicitly authorized and authenticated input over a connection to enable a switch into modes which allow OTA, spoofing, etc. from <em>UND</em> to <em>TND</em>.<ul>
<li>Example: Consent on Instrument cluster or infotainment device (and thus internal networks - possibly but not necessarily <em>TND</em>)</li>
<li>Example: Consent from third party device / application that is signed with infrastructure OEM has access to verify</li>
</ul>
</li>
</ul>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    <div class="requirement_comment">
      <div class="document">
<p>A Virtual Mode Switch can be achieved by use of a Hardware Security Module (HSM) that can verify a Message Authentication Code (MAC) of a mode change message, and where the key used for verifying the MAC can be programmed securely via remote commands.</p>
<p>Replay attacks are prevented by using a challenge-response protocol between the gateway and the remote device to exchange a sequence number or timestamp, for example the SKID3 protocol (ISO 9798-4, Chapter 5.2.2).</p>
</div>

    </div>
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul>
<li><p class="first"><a class="reference external" href="https://www.autosar.org/fileadmin/user_upload/standards/foundation/19-11/AUTOSAR_TR_SecureHardwareExtensions.pdf">https://www.autosar.org/fileadmin/user_upload/standards/foundation/19-11/AUTOSAR_TR_SecureHardwareExtensions.pdf</a> for an example of a suitable HSM (the SHE+ HSM).</p>
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms that tend to restrict access to information about the operational state of the vehicle, privacy sensitive information, financially sensitive information, detailed design information, etc.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, c.</p>
</blockquote>
<blockquote>
<p>Mechanisms that effectively secure maintenance operations, including both diagnostic procedures and update procedures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, g.</p>
</blockquote>
</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>For Virtual Mode Switch Interlock option:</p>
<p>Inspection of a third party report confirming that virtual mode switch operation cannot be simulated, initiated, sustained or denied by attacker control of devices connected to a vehicle UND.</p>
<p>For Physical Mode Switch Interlock option:</p>
<p>Test to confirm that device disables preventions only when physical input is grounded</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">
</div>
          <div class="content_item" data-role="current"><turbo-frame id="article-8369c58441fe4e02a52b7fa4240cd4b8"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.12-AGW-S-011"></div>
    <h2
class="section-title"
data-level="1.12">
  1.12.&nbsp;Mode Switch Indicated
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-011</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>Medium</dd>
    
  </dl>
    
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL indicate to all domains that it is not performing normal operations.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that there is traffic sent on TND and UND when the mode switch is set to allow.</p>
<p>AND</p>
<p>Test to confirm that when the mode switch is set to allow, this state is communicated by sending traffic to TND and UND as documented.</p>
<p>AND</p>
<p>Test to confirm that for each TND and UND, replaying the status indicated traffic by the tester does not cause the (gateway) device to then permit the preventions. Performed by repeating the tests of AGW-S-001 and AGW-S-005 while replaying.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
          <section class="content_section">
            <div class="content_item" data-role="current"><turbo-frame id="article-ff24fa8384934dea91fa426bcab6ab44"><article class="docsection" data-controller="document">

  <section data-section="meta" class="docsection_section">

    <div data-role='anchor' id="1.13-Security-Requirements-for-CAN-Gateways"></div>

    
        <h2
class="section-title"
data-level="1.13">
  1.13.&nbsp;Security Requirements for CAN Gateways
</h2>
    

  </section>

  <section data-section="description" class="docsection_section"><div class="free-text">
      <div class="document">
<p>The following security requirements must be satisfied by CAN gateways specifically. These CAN gateways are expected to meet all of the AGW-S-* Abstract Gateway security requirements and to also satisfy the CGW-S-* security requirements of this section.</p>
</div>

    </div></section></article>

</turbo-frame></div>
          </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-7247e22458e24bdbb2227aae376e5c6c"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.10-AGW-S-009"></div>
    <h2
class="section-title"
data-level="1.10">
  1.10.&nbsp;Preserves Performance
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-009</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>Medium</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.1-CGW-S-001">
      <span class="requirement_child-uid">CGW-S-001</span>
      Performant
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL be scoped to sufficient detail to preserve network domain performance guarantees in <em>TND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor reliability testing reports to confirm that the device will not cause loss of performance in TND.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-f6e8582066054d628c67fe60d6165a63"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.8-AGW-S-007"></div>
    <h2
class="section-title"
data-level="1.8">
  1.8.&nbsp;Preserves High Side Operation
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-007</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.10-AGW-S-009">
      <span class="requirement_child-uid">AGW-S-009</span>
      Preserves Performance
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.1-CGW-S-005a">
      <span class="requirement_child-uid">CGW-S-005a</span>
      Won't Drop Frames
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.2-CGW-S-005b">
      <span class="requirement_child-uid">CGW-S-005b</span>
      No Priority Inversion
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.3-CGW-S-005c">
      <span class="requirement_child-uid">CGW-S-005c</span>
      Preserves Ordering
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.4-CGW-S-005d">
      <span class="requirement_child-uid">CGW-S-005d</span>
      FIFO but Also Priority
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.5-CGW-S-005e">
      <span class="requirement_child-uid">CGW-S-005e</span>
      Preserves Jitter
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.2-CGW-S-008b">
      <span class="requirement_child-uid">CGW-S-008b</span>
      Prevents Error Passive Attack Step
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.3-CGW-S-008c">
      <span class="requirement_child-uid">CGW-S-008c</span>
      Prevents Double Receive Attack
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent degradation of any <em>TND</em> operation due to <em>UND</em> activity.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Central gateway or domain controller based architectures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, e.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul>

  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-30554e3dd00a486e996bb11d883ebdd4"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.1-CGW-S-001"></div>
    <h3
class="section-title"
data-level="1.13.1">
  1.13.1.&nbsp;Performant
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-001</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>Medium</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.10-AGW-S-009">
      <span class="requirement_parent-uid">AGW-S-009</span>
      Preserves Performance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL process and move CAN frames quickly enough to preserve performance on all network domains.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor reports to confirm that performance is sufficient for all vehicle TNDs.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
          <section class="content_section">
            <div class="content_item" data-role="current"><turbo-frame id="article-87ceca81990243889f6dbae9a2a410b1"><article class="docsection" data-controller="document">

  <section data-section="meta" class="docsection_section">

    <div data-role='anchor' id="1.13.2-Preserves-Atomic-Multicast-CGW-S-005-Series"></div>

    
        <h3
class="section-title"
data-level="1.13.2">
  1.13.2.&nbsp;Preserves Atomic Multicast: CGW-S-005* Series
</h3>
    

  </section>

  <section data-section="description" class="docsection_section"><div class="free-text">
      <div class="document">
<p>The device SHALL preserve the atomic multicast property of CAN buses. All CGW-S-005* requirements must be satisfied.</p>
</div>

    </div></section></article>

</turbo-frame></div>
          </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-f6e8582066054d628c67fe60d6165a63"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.8-AGW-S-007"></div>
    <h2
class="section-title"
data-level="1.8">
  1.8.&nbsp;Preserves High Side Operation
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-007</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.10-AGW-S-009">
      <span class="requirement_child-uid">AGW-S-009</span>
      Preserves Performance
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.1-CGW-S-005a">
      <span class="requirement_child-uid">CGW-S-005a</span>
      Won't Drop Frames
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.2-CGW-S-005b">
      <span class="requirement_child-uid">CGW-S-005b</span>
      No Priority Inversion
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.3-CGW-S-005c">
      <span class="requirement_child-uid">CGW-S-005c</span>
      Preserves Ordering
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.4-CGW-S-005d">
      <span class="requirement_child-uid">CGW-S-005d</span>
      FIFO but Also Priority
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.5-CGW-S-005e">
      <span class="requirement_child-uid">CGW-S-005e</span>
      Preserves Jitter
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.2-CGW-S-008b">
      <span class="requirement_child-uid">CGW-S-008b</span>
      Prevents Error Passive Attack Step
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.3-CGW-S-008c">
      <span class="requirement_child-uid">CGW-S-008c</span>
      Prevents Double Receive Attack
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent degradation of any <em>TND</em> operation due to <em>UND</em> activity.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Central gateway or domain controller based architectures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, e.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-77908eed4ac4469caef657aff6a2a115"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.2.1-CGW-S-005a"></div>
    <h4
class="section-title"
data-level="1.13.2.1">
  1.13.2.1.&nbsp;Won't Drop Frames
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-005a</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL NOT drop CAN frames in its bidirectional <em>UND</em> &lt;-&gt; <em>TND</em> operation, unless with explicit configuration for rate limiting or translating.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor reports to confirm that CAN frames are, by design, not dropped.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-f6e8582066054d628c67fe60d6165a63"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.8-AGW-S-007"></div>
    <h2
class="section-title"
data-level="1.8">
  1.8.&nbsp;Preserves High Side Operation
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-007</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.10-AGW-S-009">
      <span class="requirement_child-uid">AGW-S-009</span>
      Preserves Performance
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.1-CGW-S-005a">
      <span class="requirement_child-uid">CGW-S-005a</span>
      Won't Drop Frames
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.2-CGW-S-005b">
      <span class="requirement_child-uid">CGW-S-005b</span>
      No Priority Inversion
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.3-CGW-S-005c">
      <span class="requirement_child-uid">CGW-S-005c</span>
      Preserves Ordering
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.4-CGW-S-005d">
      <span class="requirement_child-uid">CGW-S-005d</span>
      FIFO but Also Priority
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.5-CGW-S-005e">
      <span class="requirement_child-uid">CGW-S-005e</span>
      Preserves Jitter
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.2-CGW-S-008b">
      <span class="requirement_child-uid">CGW-S-008b</span>
      Prevents Error Passive Attack Step
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.3-CGW-S-008c">
      <span class="requirement_child-uid">CGW-S-008c</span>
      Prevents Double Receive Attack
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent degradation of any <em>TND</em> operation due to <em>UND</em> activity.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Central gateway or domain controller based architectures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, e.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-027903bd54354baa94861480c94e0bc4"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.2.2-CGW-S-005b"></div>
    <h4
class="section-title"
data-level="1.13.2.2">
  1.13.2.2.&nbsp;No Priority Inversion
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-005b</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL schedule egress frames according to the CAN arbitration ID priority in its bidirectional <em>UND</em> &lt;-&gt; <em>TND</em> operation, to prevent priority inversion.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that device's implementation follows the rules for CAN arbitration ID priority and the prevention of priority inversion.</p>
<p>AND</p>
<p>Inspection of vendor report detailing the use of a test environment that simulates a bidirectional UND &lt;-&gt; TND operation, with different arbitration ID priorities. Where, with the test environment set up, a CAN analyzer or other monitoring tool was used to observe the device's scheduling of egress frames and verify that it followed the correct arbitration ID priority: that higher-priority frames are always transmitted before lower-priority frames. The test methodoly described in the report should be comparable to the following:</p>
<pre class="literal-block">
   +---------+                                      +---------+
   |         |                                      |         |
   | Monitor |                                      | Monitor |
   |         |                                      |         |
   +---+-----+          +--------------+            +---+-----+
+-+    |        UND     |              |    TND         |       +-+
|+|    |                |   Security   |                |       |+|
|++----+----------+-----+    Gateway   +-------+--------+-------++|
|+|               |     |              |       |                |+|
+-+               |     +--------------+       |                +-+
                  |                            |
                  |                            |
                  |        +--------+          |
                  |        |        |          |
                  +--------+ Tester +----------+
                           |        |
                           +--------+
</pre>
<p>Figure 1</p>
<p>The hardware setup is shown in Figure 1. The device under test (Security gateway) is connected to an untrusted network and a trusted network. A tester is connected to both networks and on each there is a monitor. The monitor is set up to receive traffic and acknowledge CAN frames.</p>
<p>The tester operates a frame transmission process on the Trusted network. This performs the following steps:</p>
<ol class="arabic">
<li><p class="first">Wait until frame with ID 0x010 is seen on the Trusted network.</p>
</li>
<li><p class="first">Queue in FIFO order on the Trusted bus CAN frames with the following IDs (’S’ indicates a standard 11-bit CAN ID):</p>
<ul class="simple">
<li>0x005 (S)</li>
<li>0x006 (S)</li>
</ul>
<p>and repeat this queueing of the IDs until the process is stopped.</p>
</li>
</ol>
<p>The time between steps 1 and 2 must be less than 50 microseconds (i.e. much shorter than a CAN frame transmission time).</p>
<p>The frames must be queued such that no idle time can appear between them. This is achieved by queueing the first frame and then immediately the second frame. When the first frame is transmitted then the third frame is queued. When the second frame is transmitted then the fourth frame is queued. And so on.</p>
<p>The main test process is carried out in the following steps:</p>
<ol class="arabic">
<li><p class="first">The tester queues in FIFO order on the Untrusted network CAN frames with the following IDs:</p>
<ul class="simple">
<li>0x010 (S)</li>
<li>0x011 (S)</li>
<li>0x00240000 (E)</li>
<li>0x008 (S)</li>
<li>0x001c0000 (E)</li>
<li>0x00100000 (E)</li>
<li>0x003 (S)</li>
<li>0x00080000 (E)</li>
<li>0x001 (S)</li>
</ul>
<p>,where ’S’ indicates a standard 11-bit CAN ID, ‘E’ indicates an extended 29-bit CAN ID.</p>
<p>The security gateway is programmed to allow these frames through from the Untrusted to the Trusted bus.</p>
<p>The frames are queued such that there is no idle time between them (using the technique described above).</p>
</li>
<li><p class="first">When the frame with ID 0x00100000 is seen on the Trusted bus then Trusted network process above is halted. If the frame is never seen then the Security gateway has failed the test.</p>
<p>The sequence of frames seen by the Monitor on the Untrusted bus should be:</p>
<ul class="simple">
<li>0x010 (S)</li>
<li>0x011 (S)</li>
<li>0x00240000 (E)</li>
<li>0x008 (S)</li>
<li>0x001c0000 (E)</li>
<li>0x00100000 (E)</li>
<li>0x003 (S)</li>
<li>0x00080000 (E)</li>
<li>0x001 (S)</li>
</ul>
<p>If this sequence is not seen then there is a fault in the tester.</p>
<p>The sequence of frames seen by the Monitor on the Trusted bus should be:</p>
<ul class="simple">
<li>0x010 (S)</li>
<li>0x005 (S)</li>
<li>0x006 (S)
… (0x005 and 0x006 repeated for some number of times, the exact number depending on the speed of either bus and the payloads used for the frames)</li>
<li>0x001 (S)</li>
<li>0x00080000 (E)</li>
<li>0x003 (S)</li>
<li>0x00100000 (E)</li>
<li>0x005 (S)</li>
<li>0x006 (S)
… (0x005 and 0x006 may appear again, depending on how long it takes for the tester to halt the Trusted network process)</li>
<li>0x001c0000 (E)</li>
<li>0x008 (S)</li>
<li>0x00240000 (E)</li>
<li>0x011 (S)</li>
</ul>
<p>If the sequence seen by the Monitor deviates from the above then the Security gateway has failed the test.</p>
</li>
</ol>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-f6e8582066054d628c67fe60d6165a63"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.8-AGW-S-007"></div>
    <h2
class="section-title"
data-level="1.8">
  1.8.&nbsp;Preserves High Side Operation
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-007</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.10-AGW-S-009">
      <span class="requirement_child-uid">AGW-S-009</span>
      Preserves Performance
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.1-CGW-S-005a">
      <span class="requirement_child-uid">CGW-S-005a</span>
      Won't Drop Frames
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.2-CGW-S-005b">
      <span class="requirement_child-uid">CGW-S-005b</span>
      No Priority Inversion
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.3-CGW-S-005c">
      <span class="requirement_child-uid">CGW-S-005c</span>
      Preserves Ordering
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.4-CGW-S-005d">
      <span class="requirement_child-uid">CGW-S-005d</span>
      FIFO but Also Priority
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.5-CGW-S-005e">
      <span class="requirement_child-uid">CGW-S-005e</span>
      Preserves Jitter
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.2-CGW-S-008b">
      <span class="requirement_child-uid">CGW-S-008b</span>
      Prevents Error Passive Attack Step
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.3-CGW-S-008c">
      <span class="requirement_child-uid">CGW-S-008c</span>
      Prevents Double Receive Attack
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent degradation of any <em>TND</em> operation due to <em>UND</em> activity.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Central gateway or domain controller based architectures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, e.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-8293564651414e67a72b48ca59b76012"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.2.3-CGW-S-005c"></div>
    <h4
class="section-title"
data-level="1.13.2.3">
  1.13.2.3.&nbsp;Preserves Ordering
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-005c</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL preserve ordering egress frames with respect to their ingress order within an equivalence class of CAN arbitration ID priorities, to prevent out-of-order delivery.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that the device is NOT implemented using SocketCAN -- SocketCAN drivers will randomly switch order of frames at both the same arbitration ID and among varied arbitration IDs.</p>
<p>AND</p>
<p>Inspection of vendor report detailing the use of a test environment that simulates a bidirectional UND &lt;-&gt; TND operation, with multiple nodes transmitting frames with different arbitration ID priorities. Where, with the test environment set up, a CAN analyzer or other monitoring tool was used to observe the device's scheduling of egress frames and verify that it followed the correct ordering within the same arbitration IDs: that frames are sent in the order received within the same arbitration ID.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-f6e8582066054d628c67fe60d6165a63"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.8-AGW-S-007"></div>
    <h2
class="section-title"
data-level="1.8">
  1.8.&nbsp;Preserves High Side Operation
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-007</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.10-AGW-S-009">
      <span class="requirement_child-uid">AGW-S-009</span>
      Preserves Performance
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.1-CGW-S-005a">
      <span class="requirement_child-uid">CGW-S-005a</span>
      Won't Drop Frames
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.2-CGW-S-005b">
      <span class="requirement_child-uid">CGW-S-005b</span>
      No Priority Inversion
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.3-CGW-S-005c">
      <span class="requirement_child-uid">CGW-S-005c</span>
      Preserves Ordering
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.4-CGW-S-005d">
      <span class="requirement_child-uid">CGW-S-005d</span>
      FIFO but Also Priority
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.5-CGW-S-005e">
      <span class="requirement_child-uid">CGW-S-005e</span>
      Preserves Jitter
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.2-CGW-S-008b">
      <span class="requirement_child-uid">CGW-S-008b</span>
      Prevents Error Passive Attack Step
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.3-CGW-S-008c">
      <span class="requirement_child-uid">CGW-S-008c</span>
      Prevents Double Receive Attack
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent degradation of any <em>TND</em> operation due to <em>UND</em> activity.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Central gateway or domain controller based architectures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, e.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-8f95ec2837a34fd983ef6730cd638cc8"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.2.4-CGW-S-005d"></div>
    <h4
class="section-title"
data-level="1.13.2.4">
  1.13.2.4.&nbsp;FIFO but Also Priority
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-005d</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL schedule egress for in-order send but not across CAN arbitration ID priorities.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor report detailing the use of a test environment that simulates a bidirectional UND &lt;-&gt; TND operation, with multiple nodes transmitting frames with different arbitration ID priorities. Where, with the test environment set up, a CAN analyzer or other monitoring tool was used to observe the device's scheduling of egress frames and verify that it followed the correct ordering within the same arbitration IDs: that frames are sent in the order received within the same arbitration ID but that also priority of arbitration IDs are respected.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-f6e8582066054d628c67fe60d6165a63"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.8-AGW-S-007"></div>
    <h2
class="section-title"
data-level="1.8">
  1.8.&nbsp;Preserves High Side Operation
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-007</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.10-AGW-S-009">
      <span class="requirement_child-uid">AGW-S-009</span>
      Preserves Performance
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.1-CGW-S-005a">
      <span class="requirement_child-uid">CGW-S-005a</span>
      Won't Drop Frames
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.2-CGW-S-005b">
      <span class="requirement_child-uid">CGW-S-005b</span>
      No Priority Inversion
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.3-CGW-S-005c">
      <span class="requirement_child-uid">CGW-S-005c</span>
      Preserves Ordering
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.4-CGW-S-005d">
      <span class="requirement_child-uid">CGW-S-005d</span>
      FIFO but Also Priority
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.5-CGW-S-005e">
      <span class="requirement_child-uid">CGW-S-005e</span>
      Preserves Jitter
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.2-CGW-S-008b">
      <span class="requirement_child-uid">CGW-S-008b</span>
      Prevents Error Passive Attack Step
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.3-CGW-S-008c">
      <span class="requirement_child-uid">CGW-S-008c</span>
      Prevents Double Receive Attack
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent degradation of any <em>TND</em> operation due to <em>UND</em> activity.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Central gateway or domain controller based architectures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, e.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-617eaf2e64ab427da0f1094529dc0f15"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.2.5-CGW-S-005e"></div>
    <h4
class="section-title"
data-level="1.13.2.5">
  1.13.2.5.&nbsp;Preserves Jitter
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-005e</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>Medium</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL have ingress-to-egress latency variability (jitter) low enough to not affect the <em>TND</em> network domain performance requirements in the worst case.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor report detailing the use of a test environment that simulates a network load to measure jitter of the device. Where, with the test environment set up, a CAN analyzer or other monitoring tool was used to observe the device's scheduling of egress frames and verify the jitter introduced. The test methodoly described in the report should be comparable to the following:</p>
<pre class="literal-block">
   +---------+                                      +---------+
   |         |                                      |         |
   | Monitor |                                      | Monitor |
   |         |                                      |         |
   +---+-----+          +--------------+            +---+-----+
+-+    |        UND     |              |    TND         |       +-+
|+|    |                |   Security   |                |       |+|
|++----+----------+-----+    Gateway   +-------+--------+-------++|
|+|               |     |              |       |                |+|
+-+               |     +--------------+       |                +-+
                  |                            |
                  |                            |
                  |        +--------+          |
                  |        |        |          |
                  +--------+ Tester +----------+
                           |        |
                           +--------+
</pre>
<p>Figure 1</p>
<p>The security gateway is configured to allow a test frame through the security gateway. Both the Untrusted and Trusted networks are free of any other traffic. Monitor units are set up to listen to and acknowledge CAN frames.</p>
<p>The tester checks for jitter removal by injecting a sequence of periodic frames on to the Untrusted network and measuring the timing of frames on the Trusted network.</p>
<p>In the tester, a send process is defined to run from a periodic timer event set to 100ms:</p>
<ol class="arabic simple">
<li>Wait for timing event</li>
<li>Delay for a time t</li>
<li>Queue a frame in the CAN controller connected to the Untrusted network</li>
</ol>
<p>The tester must complete the queueing of the CAN frame within 5 microseconds of the timer delay.</p>
<p>Repeat steps 1 to 3 for a sequence of values of t. The values of t should be as follows:</p>
<ul class="simple">
<li>0.5ms</li>
<li>99.0ms</li>
<li>0.5ms</li>
<li>80.0ms</li>
<li>0.5ms</li>
<li>70.0ms</li>
<li>0.5ms</li>
<li>60.0ms</li>
<li>0.5ms</li>
<li>50.0ms</li>
<li>60.0ms</li>
<li>70.0ms</li>
<li>80.0ms</li>
<li>90.0ms</li>
<li>90.0ms</li>
</ul>
<p>The tester should take accurate (1 microsecond) start-of-frame (SOF) timestamps for each CAN frame on the Trusted network.</p>
<p>The test fails if a total of 15 frames were not received from the Trusted network.</p>
<p>The test fails if time between the SOF timestamp of the first frame received and the SOF timestamp of the last frame received exceeds 1490.055ms or is less than 1489.945ms.</p>
<p>The test fails if the difference between the SOF timestamp of a frame and its subsequent frame exceeds 100.055ms or is less than 99.945ms.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
          <section class="content_section">
            <div class="content_item" data-role="current"><turbo-frame id="article-cb8363a0087e4a0c8ba7e3c21cb6be2c"><article class="docsection" data-controller="document">

  <section data-section="meta" class="docsection_section">

    <div data-role='anchor' id="1.13.3-Prevents-CAN-Attacks"></div>

    
        <h3
class="section-title"
data-level="1.13.3">
  1.13.3.&nbsp;Prevents CAN Attacks
</h3>
    

  </section>

  </article>

</turbo-frame></div>
          </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-0c9ee1effe34491798ecd40f21edcd47"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.3-AGW-S-002"></div>
    <h2
class="section-title"
data-level="1.3">
  1.3.&nbsp;Prevents DoS
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-002</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.1-CGW-S-006">
      <span class="requirement_child-uid">CGW-S-006</span>
      Prevents Bus Flood Attacks
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.4-CGW-S-008d">
      <span class="requirement_child-uid">CGW-S-008d</span>
      Prevents Bus-Off Attack
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.5-CGW-S-008e">
      <span class="requirement_child-uid">CGW-S-008e</span>
      Prevents Freeze Doom Loop Attack
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.14.2-J1939GW-S-029">
      <span class="requirement_child-uid">J1939GW-S-029</span>
      Prevents Address Claim Attacks
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating Denial of Service (DoS) on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>It is recommended to isolate safety-critical ECUs on their own CAN bus, with some sort of gateway between them and other ECUs</p>
<p class="attribution">&mdash;FMCSA GDL 37</p>
</blockquote>
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that denying access to the UND medium has no effect on TND performance.</p>
<p>AND</p>
<p>Test to confirm that for each permitted UND-&gt;TND transport, translation or encapsulation by the gateway: that sending the highest rate of traffic from UND to TND with it (one of the transport, translation or encapsulation) does not cause any performance degradation to the target device(s), nor TND in its entirety.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-2570eb6ffadf454f8995295b98bbff00"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.1-CGW-S-006"></div>
    <h4
class="section-title"
data-level="1.13.3.1">
  1.13.3.1.&nbsp;Prevents Bus Flood Attacks
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-006</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.3-AGW-S-002">
      <span class="requirement_parent-uid">AGW-S-002</span>
      Prevents DoS
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating bus flood attacks on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.1 for a description of the bus flood attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that, for both permitted and prevented UND-&gt;TND transport, translation or encapsulation by the gateway: that sending the highest rate of traffic on UND does not result in transmit at the highest rate on TND.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-ac1d5ece086f4b1b84d6dce31186fceb"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.4-AGW-S-003"></div>
    <h2
class="section-title"
data-level="1.4">
  1.4.&nbsp;Prevents Spoofing
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-003</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.2-CGW-S-007">
      <span class="requirement_child-uid">CGW-S-007</span>
      Prevents (Simple) Frame Spoofing
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.1-CGW-S-008a">
      <span class="requirement_child-uid">CGW-S-008a</span>
      Prevents Adaptive Frame Spoofing
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.14.1-J1939GW-S-039">
      <span class="requirement_child-uid">J1939GW-S-039</span>
      Prevents J1939 Address Spoofing
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent spoofing/masquerading/injection onto <em>TND</em></p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>It is recommended to isolate safety-critical ECUs on their own CAN bus, with some sort of gateway between them and other ECUs</p>
<p class="attribution">&mdash;FMCSA GDL 37</p>
</blockquote>
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that for each permitted UND-&gt;TND transport, translation or encapsulation by the gateway: that sending traffic from UND to TND with it (one of the transport, translation or encapsulation) does not cause any traffic that will be interpreted by any nodes in TND as being traffic that originated from a node in a TND.</p>
<p>AND</p>
<p>Inspection of design artifacts or a third party analysis to confirm that there is no possible traffic on UND that will result in traffic on TND that would be interpreted by any nodes in TND as being traffic that originated from a node in a TND.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-81ee81d7949b42d59c5528349dd4b4f5"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.2-CGW-S-007"></div>
    <h4
class="section-title"
data-level="1.13.3.2">
  1.13.3.2.&nbsp;Prevents (Simple) Frame Spoofing
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-007</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.4-AGW-S-003">
      <span class="requirement_parent-uid">AGW-S-003</span>
      Prevents Spoofing
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating simple frame spoofing attacks on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.2 for a description of simple frame spoofing attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that for each permitted UND-&gt;TND transport, translation or encapsulation by the gateway: that sending CAN frames from UND to TND with it (one of the transport, translation or encapsulation) does not cause any CAN frames that will be interpreted by any nodes in TND as being traffic that originated from a node in a TND.</p>
<p>AND</p>
<p>Inspection of design artifacts or a third party analysis to confirm that there is no possible CAN frames on UND that will result in CAN frames on TND that would be interpreted by any nodes in TND as being traffic that originated from a node in a TND.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
          <section class="content_section">
            <div class="content_item" data-role="current"><turbo-frame id="article-02851fcf12bb4186a80b9bc145979825"><article class="docsection" data-controller="document">

  <section data-section="meta" class="docsection_section">

    <div data-role='anchor' id="1.13.3.3-Prevents-CAN-Protocol-Attacks-CGW-S-008-Series"></div>

    
        <h4
class="section-title"
data-level="1.13.3.3">
  1.13.3.3.&nbsp;Prevents CAN Protocol Attacks: CGW-S-008* Series
</h4>
    

  </section>

  <section data-section="description" class="docsection_section"><div class="free-text">
      <div class="document">
<p>The CAN gateways must prevent CAN protocol attacks in <em>TND</em>. At the time of drafting these requirements this can be accomplished by satisfying all of the CGW-S-008* requirements that follow.</p>
<dl class="docutils">
<dt>CAN Protocol Attack</dt>
<dd>Attacks on CAN networks requiring GPIO control of CAN_TX (and optionally CAN_RX) pins.</dd>
</dl>
<p>c.f. <a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.1 for further definition of CAN protocol attacks.</p>
</div>

    </div></section></article>

</turbo-frame></div>
          </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-ac1d5ece086f4b1b84d6dce31186fceb"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.4-AGW-S-003"></div>
    <h2
class="section-title"
data-level="1.4">
  1.4.&nbsp;Prevents Spoofing
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-003</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.2-CGW-S-007">
      <span class="requirement_child-uid">CGW-S-007</span>
      Prevents (Simple) Frame Spoofing
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.1-CGW-S-008a">
      <span class="requirement_child-uid">CGW-S-008a</span>
      Prevents Adaptive Frame Spoofing
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.14.1-J1939GW-S-039">
      <span class="requirement_child-uid">J1939GW-S-039</span>
      Prevents J1939 Address Spoofing
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent spoofing/masquerading/injection onto <em>TND</em></p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>It is recommended to isolate safety-critical ECUs on their own CAN bus, with some sort of gateway between them and other ECUs</p>
<p class="attribution">&mdash;FMCSA GDL 37</p>
</blockquote>
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that for each permitted UND-&gt;TND transport, translation or encapsulation by the gateway: that sending traffic from UND to TND with it (one of the transport, translation or encapsulation) does not cause any traffic that will be interpreted by any nodes in TND as being traffic that originated from a node in a TND.</p>
<p>AND</p>
<p>Inspection of design artifacts or a third party analysis to confirm that there is no possible traffic on UND that will result in traffic on TND that would be interpreted by any nodes in TND as being traffic that originated from a node in a TND.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-493a55841b22424a87c70c90fdb7875d"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.3.1-CGW-S-008a"></div>
    <h5
class="section-title"
data-level="1.13.3.3.1">
  1.13.3.3.1.&nbsp;Prevents Adaptive Frame Spoofing
</h5>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-008a</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.4-AGW-S-003">
      <span class="requirement_parent-uid">AGW-S-003</span>
      Prevents Spoofing
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating adaptive frame spoofing attacks on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.3 for a description of adaptive frame spoofing attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that the (gateway) device is not implemented using direct-wired transceivers from TND to UND. In all other cases the delays introduced by the gateway will implicitly prevent Adaptive Frame Spoofing Attacks.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-f6e8582066054d628c67fe60d6165a63"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.8-AGW-S-007"></div>
    <h2
class="section-title"
data-level="1.8">
  1.8.&nbsp;Preserves High Side Operation
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-007</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.10-AGW-S-009">
      <span class="requirement_child-uid">AGW-S-009</span>
      Preserves Performance
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.1-CGW-S-005a">
      <span class="requirement_child-uid">CGW-S-005a</span>
      Won't Drop Frames
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.2-CGW-S-005b">
      <span class="requirement_child-uid">CGW-S-005b</span>
      No Priority Inversion
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.3-CGW-S-005c">
      <span class="requirement_child-uid">CGW-S-005c</span>
      Preserves Ordering
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.4-CGW-S-005d">
      <span class="requirement_child-uid">CGW-S-005d</span>
      FIFO but Also Priority
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.5-CGW-S-005e">
      <span class="requirement_child-uid">CGW-S-005e</span>
      Preserves Jitter
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.2-CGW-S-008b">
      <span class="requirement_child-uid">CGW-S-008b</span>
      Prevents Error Passive Attack Step
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.3-CGW-S-008c">
      <span class="requirement_child-uid">CGW-S-008c</span>
      Prevents Double Receive Attack
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent degradation of any <em>TND</em> operation due to <em>UND</em> activity.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Central gateway or domain controller based architectures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, e.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-2c2711b3632348b4943ddd0f8a49058c"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.3.2-CGW-S-008b"></div>
    <h5
class="section-title"
data-level="1.13.3.3.2">
  1.13.3.3.2.&nbsp;Prevents Error Passive Attack Step
</h5>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-008b</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating attacks that drive a ECU on <em>TND</em> into error passive state from messages originating on <em>UND</em>. This will in turn prevent error passive spoofing attacks.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.4 for a description of error passive spoofing attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that the (gateway) device does not permit direct (GPIO-like) control of the TND CAN bus from UND (e.g. anything other than direct-wiring). In all other cases the separation of UND and TND will preclude the possibility of an error passive attack step.</p>
<p>AND</p>
<p>Inspection of vendor documentation to confirm that the (gateway) device is not implemented with SoC-integrated CAN controllers whose pins can be multiplexed with GPIOs. OR To confirm that the device software has very high security assurance to guarantee that malicious software could never control the GPIOs or the pinmuxing.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-f6e8582066054d628c67fe60d6165a63"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.8-AGW-S-007"></div>
    <h2
class="section-title"
data-level="1.8">
  1.8.&nbsp;Preserves High Side Operation
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-007</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.10-AGW-S-009">
      <span class="requirement_child-uid">AGW-S-009</span>
      Preserves Performance
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.1-CGW-S-005a">
      <span class="requirement_child-uid">CGW-S-005a</span>
      Won't Drop Frames
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.2-CGW-S-005b">
      <span class="requirement_child-uid">CGW-S-005b</span>
      No Priority Inversion
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.3-CGW-S-005c">
      <span class="requirement_child-uid">CGW-S-005c</span>
      Preserves Ordering
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.4-CGW-S-005d">
      <span class="requirement_child-uid">CGW-S-005d</span>
      FIFO but Also Priority
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.2.5-CGW-S-005e">
      <span class="requirement_child-uid">CGW-S-005e</span>
      Preserves Jitter
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.2-CGW-S-008b">
      <span class="requirement_child-uid">CGW-S-008b</span>
      Prevents Error Passive Attack Step
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.3-CGW-S-008c">
      <span class="requirement_child-uid">CGW-S-008c</span>
      Prevents Double Receive Attack
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent degradation of any <em>TND</em> operation due to <em>UND</em> activity.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Central gateway or domain controller based architectures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, e.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-758d05e97c304f698efcf2a57602173e"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.3.3-CGW-S-008c"></div>
    <h5
class="section-title"
data-level="1.13.3.3.3">
  1.13.3.3.3.&nbsp;Prevents Double Receive Attack
</h5>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-008c</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.8-AGW-S-007">
      <span class="requirement_parent-uid">AGW-S-007</span>
      Preserves High Side Operation
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating double receive attacks on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.5 for a description of the double receive attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that the (gateway) device does not permit direct (GPIO-like) control of the TND CAN bus from UND (e.g. anything other than direct-wiring). In all other cases the separation of UND and TND will preclude the possibility of a double receive attack.</p>
<p>AND</p>
<p>Inspection of vendor documentation to confirm that the (gateway) device is not implemented with SoC-integrated CAN controllers whose pins can be multiplexed with GPIOs. OR To confirm that the device software has very high security assurance to guarantee that malicious software could never control the GPIOs or the pinmuxing.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-0c9ee1effe34491798ecd40f21edcd47"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.3-AGW-S-002"></div>
    <h2
class="section-title"
data-level="1.3">
  1.3.&nbsp;Prevents DoS
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-002</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.1-CGW-S-006">
      <span class="requirement_child-uid">CGW-S-006</span>
      Prevents Bus Flood Attacks
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.4-CGW-S-008d">
      <span class="requirement_child-uid">CGW-S-008d</span>
      Prevents Bus-Off Attack
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.5-CGW-S-008e">
      <span class="requirement_child-uid">CGW-S-008e</span>
      Prevents Freeze Doom Loop Attack
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.14.2-J1939GW-S-029">
      <span class="requirement_child-uid">J1939GW-S-029</span>
      Prevents Address Claim Attacks
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating Denial of Service (DoS) on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>It is recommended to isolate safety-critical ECUs on their own CAN bus, with some sort of gateway between them and other ECUs</p>
<p class="attribution">&mdash;FMCSA GDL 37</p>
</blockquote>
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that denying access to the UND medium has no effect on TND performance.</p>
<p>AND</p>
<p>Test to confirm that for each permitted UND-&gt;TND transport, translation or encapsulation by the gateway: that sending the highest rate of traffic from UND to TND with it (one of the transport, translation or encapsulation) does not cause any performance degradation to the target device(s), nor TND in its entirety.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-90468492a75b4445b6b672eeba91e171"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.3.4-CGW-S-008d"></div>
    <h5
class="section-title"
data-level="1.13.3.3.4">
  1.13.3.3.4.&nbsp;Prevents Bus-Off Attack
</h5>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-008d</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.3-AGW-S-002">
      <span class="requirement_parent-uid">AGW-S-002</span>
      Prevents DoS
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating bus-off attacks on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.6 for a description of the bus-off attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that the (gateway) device does not permit direct (GPIO-like) control of the TND CAN bus from UND (e.g. anything other than direct-wiring). In all other cases the separation of UND and TND will preclude the possibility of a bus off attack.</p>
<p>AND</p>
<p>Inspection of vendor documentation to confirm that the (gateway) device is not implemented with SoC-integrated CAN controllers whose pins can be multiplexed with GPIOs. OR To confirm that the device software has very high security assurance to guarantee that malicious software could never control the GPIOs or the pinmuxing.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-0c9ee1effe34491798ecd40f21edcd47"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.3-AGW-S-002"></div>
    <h2
class="section-title"
data-level="1.3">
  1.3.&nbsp;Prevents DoS
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-002</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.1-CGW-S-006">
      <span class="requirement_child-uid">CGW-S-006</span>
      Prevents Bus Flood Attacks
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.4-CGW-S-008d">
      <span class="requirement_child-uid">CGW-S-008d</span>
      Prevents Bus-Off Attack
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.5-CGW-S-008e">
      <span class="requirement_child-uid">CGW-S-008e</span>
      Prevents Freeze Doom Loop Attack
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.14.2-J1939GW-S-029">
      <span class="requirement_child-uid">J1939GW-S-029</span>
      Prevents Address Claim Attacks
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating Denial of Service (DoS) on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>It is recommended to isolate safety-critical ECUs on their own CAN bus, with some sort of gateway between them and other ECUs</p>
<p class="attribution">&mdash;FMCSA GDL 37</p>
</blockquote>
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that denying access to the UND medium has no effect on TND performance.</p>
<p>AND</p>
<p>Test to confirm that for each permitted UND-&gt;TND transport, translation or encapsulation by the gateway: that sending the highest rate of traffic from UND to TND with it (one of the transport, translation or encapsulation) does not cause any performance degradation to the target device(s), nor TND in its entirety.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-fae1fd80dc34404fb81f733b61edb75f"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.3.5-CGW-S-008e"></div>
    <h5
class="section-title"
data-level="1.13.3.3.5">
  1.13.3.3.5.&nbsp;Prevents Freeze Doom Loop Attack
</h5>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-008e</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.3-AGW-S-002">
      <span class="requirement_parent-uid">AGW-S-002</span>
      Prevents DoS
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating freeze doom loop attacks on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf">https://canislabs.com/downloads/2020-02-14-White-Paper-CAN-Security.pdf</a> section 2.7 for a description of the freeze doom loop attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that the (gateway) device does not permit direct (GPIO-like) control of the TND CAN bus from UND (e.g. anything other than direct-wiring). In all other cases the separation of UND and TND will preclude the possibility of a freeze doom loop attack</p>
<p>AND</p>
<p>Inspection of vendor documentation to confirm that the (gateway) device is not implemented with SoC-integrated CAN controllers whose pins can be multiplexed with GPIOs. OR To confirm that the device software has very high security assurance to guarantee that malicious software could never control the GPIOs or the pinmuxing.</p>
<p>AND</p>
<p>Inspection of design artifacts or a third party analysis to confirm that there is no possible CAN frames on UND that will result in CAN frames on TND that would match any arbitration IDs sent by nodes on TND. Otherwise there is a non-zero probability that the gateway's TND CAN controller could enter a freeze doom loop with a node on TND.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-6c5dc5c658724c7898e18edf0a28ef1a"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.9-AGW-S-008"></div>
    <h2
class="section-title"
data-level="1.9">
  1.9.&nbsp;Security Assurance
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-008</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.4-CGW-S-013">
      <span class="requirement_child-uid">CGW-S-013</span>
      Impervious to Janus Attack
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.14.3-J1939GW-S-089">
      <span class="requirement_child-uid">J1939GW-S-089</span>
      Impervious to Address Claim Attacks
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL satisfy a comprehensive set of product security requirements to yield high assurance of correct operation in the face of adversarial inputs to the device.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms that tend to restrict access to information about the operational state of the vehicle, privacy sensitive information, financially sensitive information, detailed design information, etc.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, c.</p>
</blockquote>
<blockquote>
<p>Mechanisms that effectively secure maintenance operations, including both diagnostic procedures and update procedures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, g.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of a third party report to confirm that the device has no known vulnerabilities that could undermine the preventions listed previously, the security requirements of this series, or other the security requirements of derivative series.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-c2b2c5d05e594e8ab9c64b261e0932c3"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.13.3.4-CGW-S-013"></div>
    <h4
class="section-title"
data-level="1.13.3.4">
  1.13.3.4.&nbsp;Impervious to Janus Attack
</h4>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>CGW-S-013</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>Medium</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.9-AGW-S-008">
      <span class="requirement_parent-uid">AGW-S-008</span>
      Security Assurance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL not enable Janus Attacks in any group of OEM supplied components on any of its interfaces.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    <div class="requirement_comment">
      <div class="document">
<p>Susceptibility to Janus Attacks is a property of a network of devices, not only of a single device. The entire <em>TND</em> is expected to be impervious to Janus Attacks since it should all be OEM supplied components there. In <em>UND</em> it is not possible to require that this device nor all the devices are impervious to Janus Attacks since <em>UND</em> is explicitly permitted to contain non-OEM supplied components. What is required of this device on <em>UND</em> is that if there are other OEM supplied devices on <em>UND</em> then this device cannot enable Janus Attacks on that collection of all those OEM supplied devices on <em>UND</em>.</p>
</div>

    </div>
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://kentindell.github.io/2021/07/15/janus-attack/">https://kentindell.github.io/2021/07/15/janus-attack/</a> for a description of the Janus Attack</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor report to confirm that all devices on TND have been tested to demonstrate the same configured CAN sampling point.</p>
<p>AND</p>
<p>Inspection of vendor report to confirm that all original devices on UND have been tested to demonstrate the same configured CAN sampling point.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
          <section class="content_section">
            <div class="content_item" data-role="current"><turbo-frame id="article-538fedc33216479fb05693fb4a8609d4"><article class="docsection" data-controller="document">

  <section data-section="meta" class="docsection_section">

    <div data-role='anchor' id="1.14-Security-Requirements-for-J1939-Gateways"></div>

    
        <h2
class="section-title"
data-level="1.14">
  1.14.&nbsp;Security Requirements for J1939 Gateways
</h2>
    

  </section>

  <section data-section="description" class="docsection_section"><div class="free-text">
      <div class="document">
<p>J1939 Gateways are expected to meet all of the CGW-S-* CAN Gateway Security Requirements and to also satisfy the J1939GW-S-* Security requirements of this section</p>
</div>

    </div></section></article>

</turbo-frame></div>
          </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-ac1d5ece086f4b1b84d6dce31186fceb"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.4-AGW-S-003"></div>
    <h2
class="section-title"
data-level="1.4">
  1.4.&nbsp;Prevents Spoofing
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-003</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.2-CGW-S-007">
      <span class="requirement_child-uid">CGW-S-007</span>
      Prevents (Simple) Frame Spoofing
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.1-CGW-S-008a">
      <span class="requirement_child-uid">CGW-S-008a</span>
      Prevents Adaptive Frame Spoofing
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.14.1-J1939GW-S-039">
      <span class="requirement_child-uid">J1939GW-S-039</span>
      Prevents J1939 Address Spoofing
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent spoofing/masquerading/injection onto <em>TND</em></p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>It is recommended to isolate safety-critical ECUs on their own CAN bus, with some sort of gateway between them and other ECUs</p>
<p class="attribution">&mdash;FMCSA GDL 37</p>
</blockquote>
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that for each permitted UND-&gt;TND transport, translation or encapsulation by the gateway: that sending traffic from UND to TND with it (one of the transport, translation or encapsulation) does not cause any traffic that will be interpreted by any nodes in TND as being traffic that originated from a node in a TND.</p>
<p>AND</p>
<p>Inspection of design artifacts or a third party analysis to confirm that there is no possible traffic on UND that will result in traffic on TND that would be interpreted by any nodes in TND as being traffic that originated from a node in a TND.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-1f047de2ed8e4a61a4260b54e833622c"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.14.1-J1939GW-S-039"></div>
    <h3
class="section-title"
data-level="1.14.1">
  1.14.1.&nbsp;Prevents J1939 Address Spoofing
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>J1939GW-S-039</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>Medium</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.4-AGW-S-003">
      <span class="requirement_parent-uid">AGW-S-003</span>
      Prevents Spoofing
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device shall prevent the gatewaying (any of transport, translate, filter, or encapsulate) of any traffic onto <em>TND</em> with a J1939 address which is claimed by any of the devices in <em>TND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that for all source addresses claimed on TND, sending J1939 frames with any such source address is prevented from being transported, translated or encapsulated by the gateway to the TND; regardless of  permitted UND-&gt;TND transport, translation or encapsulation mechanisms that maybe configured on the gateway.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-0c9ee1effe34491798ecd40f21edcd47"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.3-AGW-S-002"></div>
    <h2
class="section-title"
data-level="1.3">
  1.3.&nbsp;Prevents DoS
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-002</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.1-CGW-S-006">
      <span class="requirement_child-uid">CGW-S-006</span>
      Prevents Bus Flood Attacks
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.4-CGW-S-008d">
      <span class="requirement_child-uid">CGW-S-008d</span>
      Prevents Bus-Off Attack
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.3.5-CGW-S-008e">
      <span class="requirement_child-uid">CGW-S-008e</span>
      Prevents Freeze Doom Loop Attack
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.14.2-J1939GW-S-029">
      <span class="requirement_child-uid">J1939GW-S-029</span>
      Prevents Address Claim Attacks
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating Denial of Service (DoS) on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>It is recommended to isolate safety-critical ECUs on their own CAN bus, with some sort of gateway between them and other ECUs</p>
<p class="attribution">&mdash;FMCSA GDL 37</p>
</blockquote>
<blockquote>
<p>Isolation/partitioning of systems that have external access (e.g., Wi Fi, Bluetooth, OBD) from safety-critical systems and systems that can have important impacts on the operation of the vehicle.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, a.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that denying access to the UND medium has no effect on TND performance.</p>
<p>AND</p>
<p>Test to confirm that for each permitted UND-&gt;TND transport, translation or encapsulation by the gateway: that sending the highest rate of traffic from UND to TND with it (one of the transport, translation or encapsulation) does not cause any performance degradation to the target device(s), nor TND in its entirety.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-9b3d7c788d984a27b690e130455345d2"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.14.2-J1939GW-S-029"></div>
    <h3
class="section-title"
data-level="1.14.2">
  1.14.2.&nbsp;Prevents Address Claim Attacks
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>J1939GW-S-029</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.3-AGW-S-002">
      <span class="requirement_parent-uid">AGW-S-002</span>
      Prevents DoS
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL prevent generating address claim attacks on <em>TND</em> from messages originating on <em>UND</em>.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    <div class="requirement_comment">
      <div class="document">
<p><strong>Note to implementors</strong>: Performing no gatewaying (any of transport, translate, filter, or encapsulate) of address claims onto <em>TND</em> would satisfy this requirement.</p>
</div>

    </div>
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://www.aut.upt.ro/~bgroza/Papers/j1939.pdf">https://www.aut.upt.ro/~bgroza/Papers/j1939.pdf</a> and <a class="reference external" href="https://doi.org/10.4271/02-14-03-0026">https://doi.org/10.4271/02-14-03-0026</a> for a description of the address claim attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Test to confirm that for all source addresses claimed on TND, no address claims can be sent from UND for that address regardless of permitted transports, translations or encapsulations configured.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-6c5dc5c658724c7898e18edf0a28ef1a"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.9-AGW-S-008"></div>
    <h2
class="section-title"
data-level="1.9">
  1.9.&nbsp;Security Assurance
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>AGW-S-008</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.13.3.4-CGW-S-013">
      <span class="requirement_child-uid">CGW-S-013</span>
      Impervious to Janus Attack
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#1.14.3-J1939GW-S-089">
      <span class="requirement_child-uid">J1939GW-S-089</span>
      Impervious to Address Claim Attacks
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL satisfy a comprehensive set of product security requirements to yield high assurance of correct operation in the face of adversarial inputs to the device.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms that tend to restrict access to information about the operational state of the vehicle, privacy sensitive information, financially sensitive information, detailed design information, etc.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, c.</p>
</blockquote>
<blockquote>
<p>Mechanisms that effectively secure maintenance operations, including both diagnostic procedures and update procedures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, g.</p>
</blockquote>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of a third party report to confirm that the device has no known vulnerabilities that could undermine the preventions listed previously, the security requirements of this series, or other the security requirements of derivative series.</p>
<p>AND</p>
<p>All the verification steps of all the applicable derivative requirements.</p>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-2931e5eb0881479db7e81c09fdc1cc55"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="1.14.3-J1939GW-S-089"></div>
    <h3
class="section-title"
data-level="1.14.3">
  1.14.3.&nbsp;Impervious to Address Claim Attacks
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>J1939GW-S-089</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#1.9-AGW-S-008">
      <span class="requirement_parent-uid">AGW-S-008</span>
      Security Assurance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>The device SHALL not be susceptible to address claim attacks on any of its interfaces (e.g. <em>TND</em> and <em>UND</em>)</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<ul class="simple">
<li><a class="reference external" href="https://www.aut.upt.ro/~bgroza/Papers/j1939.pdf">https://www.aut.upt.ro/~bgroza/Papers/j1939.pdf</a> and <a class="reference external" href="https://doi.org/10.4271/02-14-03-0026">https://doi.org/10.4271/02-14-03-0026</a> for a description of the address claim attack.</li>
</ul>
</div>
</div>
    <div class="requirement_meta_multiline_label">VERIFICATION:</div>
    <div class="requirement_meta_multiline"><div class="document">
<p>Inspection of vendor documentation to confirm that mitigations against address claim attacks are implemented on all of the interfaces of the device.</p>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
          <section class="content_section">
            <div class="content_item" data-role="current"><turbo-frame id="article-c5e880cb035e4293a010f6b8e3c98e13"><article class="docsection" data-controller="document">

  <section data-section="meta" class="docsection_section">

    <div data-role='anchor' id="2-Security-Requirements-for-Abstract-Unintended-Gateways"></div>

    
        <h1
class="section-title"
data-level="2">
  2.&nbsp;Security Requirements for Abstract Unintended Gateways
</h1>
    

  </section>

  <section data-section="description" class="docsection_section"><div class="free-text">
      <div class="document">
<p>Security requirements that must be satisfied by any device which <em>could be</em> a gateway (due to malicious code) but is not intended to be one.</p>
</div>

    </div></section></article>

</turbo-frame></div>
          </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">
</div>
          <div class="content_item" data-role="current"><turbo-frame id="article-48fe5ecbaf214683887f18347e4ca5a7"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="2.1-NGW-S-001"></div>
    <h2
class="section-title"
data-level="2.1">
  2.1.&nbsp;Security Assurance
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>NGW-S-001</dd>
    
    <dt><i>VERIFICATION</i></dt>
    <dd>
</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.1-NGW-S-002">
      <span class="requirement_child-uid">NGW-S-002</span>
      Won't Transport
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.2-NGW-S-003">
      <span class="requirement_child-uid">NGW-S-003</span>
      Won't Translate
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.3-NGW-S-004">
      <span class="requirement_child-uid">NGW-S-004</span>
      Won't Filter, Drop or Rate Limit
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.4-NGW-S-005">
      <span class="requirement_child-uid">NGW-S-005</span>
      Won't Encapsulate
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL satisfy a comprehensive set of product security requirements to yield high assurance of correct operation in the face of adversarial inputs to the device.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms that tend to restrict access to information about the operational state of the vehicle, privacy sensitive information, financially sensitive information, detailed design information, etc.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, c.</p>
</blockquote>
<blockquote>
<p>Mechanisms that effectively secure maintenance operations, including both diagnostic procedures and update procedures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, g.</p>
</blockquote>
</div>
</div>

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">

<ul class="requirement-tree requirement-tree_right"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-940cf9ae5b2746048e407ebee3a1f8a2"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="2.2.1-NGW-S-002"></div>
    <h3
class="section-title"
data-level="2.2.1">
  2.2.1.&nbsp;Won't Transport
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>NGW-S-002</dd>
    
    <dt><i>VERIFICATION</i></dt>
    <dd>
</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#2.1-NGW-S-001">
      <span class="requirement_parent-uid">NGW-S-001</span>
      Security Assurance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL NOT transport/'move' information between two separate network 'domains,' in either bidirection.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-e61e87432a3d48bda582d4550a08657c"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="2.2.2-NGW-S-003"></div>
    <h3
class="section-title"
data-level="2.2.2">
  2.2.2.&nbsp;Won't Translate
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>NGW-S-003</dd>
    
    <dt><i>VERIFICATION</i></dt>
    <dd>
</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#2.1-NGW-S-001">
      <span class="requirement_parent-uid">NGW-S-001</span>
      Security Assurance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL NOT translate/transform the information between the separate network domains.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-4732b6d0753746c69f49782043616ad6"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="2.2.3-NGW-S-004"></div>
    <h3
class="section-title"
data-level="2.2.3">
  2.2.3.&nbsp;Won't Filter, Drop or Rate Limit
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>NGW-S-004</dd>
    
    <dt><i>VERIFICATION</i></dt>
    <dd>
</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#2.1-NGW-S-001">
      <span class="requirement_parent-uid">NGW-S-001</span>
      Security Assurance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL NOT select which information is transported and/or translated between the network domains.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  

  </section></article>

</turbo-frame>
    </div>


  </li><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-a9ef6dba4f424519a4d1b1999d31bac8"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="2.2.4-NGW-S-005"></div>
    <h3
class="section-title"
data-level="2.2.4">
  2.2.4.&nbsp;Won't Encapsulate
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>NGW-S-005</dd>
    
    <dt><i>VERIFICATION</i></dt>
    <dd>
</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#2.1-NGW-S-001">
      <span class="requirement_parent-uid">NGW-S-001</span>
      Security Assurance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL NOT encapsulate information as it is transported and/or translated between the network domains.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
        </section>
          <section class="content_section">
            <div class="content_item" data-role="current"><turbo-frame id="article-c462285aeed84efe8dea67cabf0dccf4"><article class="docsection" data-controller="document">

  <section data-section="meta" class="docsection_section">

    <div data-role='anchor' id="2.2-Prevents-Gateway-Functions"></div>

    
        <h2
class="section-title"
data-level="2.2">
  2.2.&nbsp;Prevents Gateway Functions
</h2>
    

  </section>

  </article>

</turbo-frame></div>
          </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-48fe5ecbaf214683887f18347e4ca5a7"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="2.1-NGW-S-001"></div>
    <h2
class="section-title"
data-level="2.1">
  2.1.&nbsp;Security Assurance
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>NGW-S-001</dd>
    
    <dt><i>VERIFICATION</i></dt>
    <dd>
</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.1-NGW-S-002">
      <span class="requirement_child-uid">NGW-S-002</span>
      Won't Transport
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.2-NGW-S-003">
      <span class="requirement_child-uid">NGW-S-003</span>
      Won't Translate
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.3-NGW-S-004">
      <span class="requirement_child-uid">NGW-S-004</span>
      Won't Filter, Drop or Rate Limit
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.4-NGW-S-005">
      <span class="requirement_child-uid">NGW-S-005</span>
      Won't Encapsulate
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL satisfy a comprehensive set of product security requirements to yield high assurance of correct operation in the face of adversarial inputs to the device.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms that tend to restrict access to information about the operational state of the vehicle, privacy sensitive information, financially sensitive information, detailed design information, etc.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, c.</p>
</blockquote>
<blockquote>
<p>Mechanisms that effectively secure maintenance operations, including both diagnostic procedures and update procedures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, g.</p>
</blockquote>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-940cf9ae5b2746048e407ebee3a1f8a2"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="2.2.1-NGW-S-002"></div>
    <h3
class="section-title"
data-level="2.2.1">
  2.2.1.&nbsp;Won't Transport
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>NGW-S-002</dd>
    
    <dt><i>VERIFICATION</i></dt>
    <dd>
</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#2.1-NGW-S-001">
      <span class="requirement_parent-uid">NGW-S-001</span>
      Security Assurance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL NOT transport/'move' information between two separate network 'domains,' in either bidirection.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-48fe5ecbaf214683887f18347e4ca5a7"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="2.1-NGW-S-001"></div>
    <h2
class="section-title"
data-level="2.1">
  2.1.&nbsp;Security Assurance
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>NGW-S-001</dd>
    
    <dt><i>VERIFICATION</i></dt>
    <dd>
</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.1-NGW-S-002">
      <span class="requirement_child-uid">NGW-S-002</span>
      Won't Transport
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.2-NGW-S-003">
      <span class="requirement_child-uid">NGW-S-003</span>
      Won't Translate
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.3-NGW-S-004">
      <span class="requirement_child-uid">NGW-S-004</span>
      Won't Filter, Drop or Rate Limit
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.4-NGW-S-005">
      <span class="requirement_child-uid">NGW-S-005</span>
      Won't Encapsulate
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL satisfy a comprehensive set of product security requirements to yield high assurance of correct operation in the face of adversarial inputs to the device.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms that tend to restrict access to information about the operational state of the vehicle, privacy sensitive information, financially sensitive information, detailed design information, etc.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, c.</p>
</blockquote>
<blockquote>
<p>Mechanisms that effectively secure maintenance operations, including both diagnostic procedures and update procedures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, g.</p>
</blockquote>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-e61e87432a3d48bda582d4550a08657c"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="2.2.2-NGW-S-003"></div>
    <h3
class="section-title"
data-level="2.2.2">
  2.2.2.&nbsp;Won't Translate
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>NGW-S-003</dd>
    
    <dt><i>VERIFICATION</i></dt>
    <dd>
</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#2.1-NGW-S-001">
      <span class="requirement_parent-uid">NGW-S-001</span>
      Security Assurance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL NOT translate/transform the information between the separate network domains.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-48fe5ecbaf214683887f18347e4ca5a7"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="2.1-NGW-S-001"></div>
    <h2
class="section-title"
data-level="2.1">
  2.1.&nbsp;Security Assurance
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>NGW-S-001</dd>
    
    <dt><i>VERIFICATION</i></dt>
    <dd>
</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.1-NGW-S-002">
      <span class="requirement_child-uid">NGW-S-002</span>
      Won't Transport
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.2-NGW-S-003">
      <span class="requirement_child-uid">NGW-S-003</span>
      Won't Translate
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.3-NGW-S-004">
      <span class="requirement_child-uid">NGW-S-004</span>
      Won't Filter, Drop or Rate Limit
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.4-NGW-S-005">
      <span class="requirement_child-uid">NGW-S-005</span>
      Won't Encapsulate
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL satisfy a comprehensive set of product security requirements to yield high assurance of correct operation in the face of adversarial inputs to the device.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms that tend to restrict access to information about the operational state of the vehicle, privacy sensitive information, financially sensitive information, detailed design information, etc.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, c.</p>
</blockquote>
<blockquote>
<p>Mechanisms that effectively secure maintenance operations, including both diagnostic procedures and update procedures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, g.</p>
</blockquote>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-4732b6d0753746c69f49782043616ad6"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="2.2.3-NGW-S-004"></div>
    <h3
class="section-title"
data-level="2.2.3">
  2.2.3.&nbsp;Won't Filter, Drop or Rate Limit
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>NGW-S-004</dd>
    
    <dt><i>VERIFICATION</i></dt>
    <dd>
</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#2.1-NGW-S-001">
      <span class="requirement_parent-uid">NGW-S-001</span>
      Security Assurance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL NOT select which information is transported and/or translated between the network domains.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
        <section class="content_section">
          <div class="content_item" data-role="parents">

<ul class="requirement-tree requirement-tree_left"><li class="requirement-tree_branch">
    <div class="requirement-tree_node">
      <turbo-frame id="article-48fe5ecbaf214683887f18347e4ca5a7"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="2.1-NGW-S-001"></div>
    <h2
class="section-title"
data-level="2.1">
  2.1.&nbsp;Security Assurance
</h2>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>NGW-S-001</dd>
    
    <dt><i>VERIFICATION</i></dt>
    <dd>
</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.1-NGW-S-002">
      <span class="requirement_child-uid">NGW-S-002</span>
      Won't Transport
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.2-NGW-S-003">
      <span class="requirement_child-uid">NGW-S-003</span>
      Won't Translate
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.3-NGW-S-004">
      <span class="requirement_child-uid">NGW-S-004</span>
      Won't Filter, Drop or Rate Limit
    </a>
  </li>
  <li>
    <a data-turbo="false" class="requirement_link-child" href="#2.2.4-NGW-S-005">
      <span class="requirement_child-uid">NGW-S-005</span>
      Won't Encapsulate
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL satisfy a comprehensive set of product security requirements to yield high assurance of correct operation in the face of adversarial inputs to the device.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  
    <div class="requirement_meta_multiline_label">PUB_REFS:</div>
    <div class="requirement_meta_multiline"><div class="document">
<blockquote>
<p>Access control mechanisms to restrict access to critical ECUs, critical modes of every ECU (diagnostic mode), and their data.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, b.</p>
</blockquote>
<blockquote>
<p>Access control mechanisms that tend to restrict access to information about the operational state of the vehicle, privacy sensitive information, financially sensitive information, detailed design information, etc.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, c.</p>
</blockquote>
<blockquote>
<p>Mechanisms that effectively secure maintenance operations, including both diagnostic procedures and update procedures.</p>
<p class="attribution">&mdash;SAE J3061: Appendix F - VEHICLE LEVEL CONSIDERATIONS, Security Mechanisms, g.</p>
</blockquote>
</div>
</div>

  </section></article>

</turbo-frame>
    </div>


  </li></ul></div>
          <div class="content_item" data-role="current"><turbo-frame id="article-a9ef6dba4f424519a4d1b1999d31bac8"><article class="requirement">

  <section class="requirement_section" data-section='meta'>

    <div data-role='anchor' id="2.2.4-NGW-S-005"></div>
    <h3
class="section-title"
data-level="2.2.4">
  2.2.4.&nbsp;Won't Encapsulate
</h3>

    <dl class="requirement_meta">
    
    <dt><i>UID</i></dt>
    <dd>NGW-S-005</dd>
    
    <dt><i>VERIFICATION</i></dt>
    <dd>
</dd>
    
    <dt><i>CRITICALITY</i></dt>
    <dd>High</dd>
    
  </dl>
    
<ul class="requirement_link">
  <li>
    <a data-turbo="false" class="requirement_link-parent" href="#2.1-NGW-S-001">
      <span class="requirement_parent-uid">NGW-S-001</span>
      Security Assurance
    </a>
  </li>
  </ul>
    

  </section>
  <section class="requirement_section" data-section='statement'>

    <div class="requirement_statement">
    <div class="document">
<p>These devices SHALL NOT encapsulate information as it is transported and/or translated between the network domains.</p>
</div>

  </div>

  </section>
  <section class="requirement_section" data-section='comment'>

    
    
    
  

  </section></article>

</turbo-frame></div>

          <div class="content_item" data-role="children">
</div>
        </section>
      </div>


    </main>

  </div>
  
  <script>
    $(document).ready(function () {
      // Quick and dirty scrolling to the middle of the document.
      var table = $('.table').first();
      window.scrollBy(table.outerWidth() / 2 - $(window).width() / 2, 0);
    });
  </script>

</body>
</html>